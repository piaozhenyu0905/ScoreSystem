"use strict";(self["webpackChunkscoring_system_front"]=self["webpackChunkscoring_system_front"]||[]).push([[410],{4945:function(e,t,a){a.d(t,{JZ:function(){return r},aq:function(){return i},lc:function(){return o},sv:function(){return l},tq:function(){return s}});var n=a(5857);const l=(e,t,a,l,r)=>new Promise(((o,s)=>{let i={pageNum:e,pageSize:t,department:a,role:l,username:r};(0,n.A)({method:"post",url:"/api/basicInfos",headers:{"Content-Type":"application/json"},data:JSON.stringify(i)}).then((e=>{o(e)})).catch((e=>{s(e.response)}))})),r=()=>new Promise(((e,t)=>{(0,n.A)({method:"post",url:"/api/departments",headers:{"Content-Type":"application/json"}}).then((t=>{e(t)})).catch((e=>{t(e.response)}))})),o=e=>new Promise(((t,a)=>{(0,n.A)({method:"delete",url:"/api/delete/user",headers:{"Content-Type":"application/json"},params:{id:e}}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),s=e=>new Promise(((t,a)=>{let l=new FormData;l.append("file",e),(0,n.A)({method:"post",url:"/api/upload",headers:{"Content-Type":"multipart/form-data"},data:l}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),i=e=>new Promise(((t,a)=>{let l={ids:e};(0,n.A)({method:"delete",url:"/api/delete/users",headers:{"Content-Type":"application/json"},data:JSON.stringify(l)}).then((e=>{t(e)})).catch((e=>{a(e.response)}))}))},8410:function(e,t,a){a.r(t),a.d(t,{default:function(){return z}});a(9138);var n=a(5115),l=a(9650),r=a(7296),o=a(9675),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},i=s,c=a(1844);function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(a);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable})))),n.forEach((function(t){u(e,t,a[t])}))}return e}function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var p=function(e,t){var a=d({},e,t.attrs);return(0,n.bF)(c.A,d({},a,{icon:i}),null)};p.displayName="FormOutlined",p.inheritAttrs=!1;var h=p,g=a(3771),m=a(4945),y=a(5857);const v=(e,t,a,n,l)=>new Promise(((r,o)=>{let s={pageNum:e,pageSize:t,name:a,department:n,state:l};(0,y.A)({method:"post",url:"/api/average/score",headers:{"Content-Type":"application/json"},data:JSON.stringify(s)}).then((e=>{r(e)})).catch((e=>{o(e.response)}))})),f=e=>new Promise(((t,a)=>{(0,y.A)({method:"get",url:"/api/average/score/detail",headers:{"Content-Type":"application/json"},params:{id:e}}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),k=(e,t)=>new Promise(((a,n)=>{let l={confidenceLevel:t,userId:e};(0,y.A)({method:"post",url:"/api/confidenceLevel/config",headers:{"Content-Type":"application/json"},data:JSON.stringify(l)}).then((e=>{a(e)})).catch((e=>{n(e.response)}))})),w=e=>new Promise(((t,a)=>{(0,y.A)({method:"get",url:"/api/reject",headers:{"Content-Type":"application/json"},params:{id:e}}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),b=e=>new Promise(((t,a)=>{(0,y.A)({method:"get",url:"/api/confirm/score/single",headers:{"Content-Type":"application/json"},params:{id:e}}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),x=e=>new Promise(((t,a)=>{let n={userIds:e};(0,y.A)({method:"post",url:"/api/confirm/score/many",headers:{"Content-Type":"application/json"},data:JSON.stringify(n)}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),A=()=>new Promise(((e,t)=>{(0,y.A)({method:"get",url:"/api/score/step",headers:{"Content-Type":"application/json"}}).then((t=>{e(t)})).catch((e=>{t(e.response)}))}));var R=a(543);const I={key:0,class:"rate-board"},C={class:"content-header"},_={class:"search-form"},F={class:"submit-Btn"},K={class:"content-table"},L={class:"action-btn"},E=["onClick"],P=["onClick"],S=["onClick"],O={style:{padding:"5px 5px 0px 5px"}},j={style:{color:"#3894FF"}},W={key:1,class:"no-permission"};var T={__name:"RateBoard",setup(e){const t=(0,o.KR)(localStorage.getItem("userRole")),a=(0,o.KR)(!1);"3"===t.value&&(a.value=!0);const s=(0,o.KR)(!0),i=(0,o.KR)(),c=()=>{(0,R.Q)().then((e=>{if(200===e.data.code)for(let t=0;t<=e.data.data.evaluateStep.length-1;t++)1===e.data.data.evaluateStep[t].enable&&(i.value=t+1+"","2"!==i.value&&(s.value=!1));else g.Ay.error("获取失败！"+e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))},d=(0,o.Kh)({name:null,department:null,status:null}),u=(0,o.Kh)({current:1,pageSize:15,total:0,showTotal:(e,t)=>`总共 ${e} 条数据`}),p=(0,o.KR)([]),y=()=>{(0,m.JZ)().then((e=>{200===e.data.code?p.value=e.data.data:g.Ay.error("获取部门列表失败,"+e.data.msg)})).catch((e=>{g.Ay.error("请求失败",e)}))},T=()=>{u.current=1,V()},B=(0,o.KR)([{title:"序号",dataIndex:"id",key:"id",fixed:"left",align:"center",width:65},{title:"评估人",dataIndex:"Evaluator",key:"Evaluator",fixed:"left",align:"center",width:90},{title:"部门",dataIndex:"department",key:"department",align:"center",width:90},{title:"状态",dataIndex:"status",key:"status",align:"center",width:80,slots:{customRender:"status"}},{title:"置信度",dataIndex:"confidence",key:"confidence",align:"center",width:75},{title:"开放进取 (O)",dataIndex:"openProgressive",key:"openProgressive",align:"center",width:100},{title:"打胜仗作为信仰 (W)",dataIndex:"winBelief",key:"winBelief",align:"center",width:110},{title:"创新求实 (I)",dataIndex:"innovationRealism",key:"innovationRealism",align:"center",width:100},{title:"信任互助 (H)",dataIndex:"trustHelp",key:"trustHelp",align:"center",width:100},{title:"尊重平等 (R)",dataIndex:"respectEquality",key:"respectEquality",align:"center",width:100},{title:"业精于勤 (D)",dataIndex:"diligenceExcellence",key:"diligenceExcellence",align:"center",width:100},{title:"使命必达 (M)",dataIndex:"missionAccomplished",key:"missionAccomplished",align:"center",width:100},{title:"五湖四海 (F)",dataIndex:"globalView",key:"globalView",align:"center",width:100},{title:"坚持自省 (I)",dataIndex:"selfReflection",key:"selfReflection",align:"center",width:100},{title:"操作",key:"action",fixed:"right",align:"center",width:260,slots:{customRender:"action"}}]),N=(0,o.KR)([]),z=(0,o.KR)("60vh"),H=()=>{const e=window.innerHeight,t=e-50-10;z.value=e<800?.6*t+"px":.67*t+"px"},V=()=>{N.value=[],v(u.current,u.pageSize,d.name,d.department,d.status).then((e=>{if(200===e.data.code){u.total=e.data.data.total;const t=e.data.data.data;for(let e=0;e<t.length;e++)N.value.push({id:u.current*u.pageSize-u.pageSize+e+1,userId:t[e].userId,Evaluator:t[e].evaluatorName,department:t[e].department,openProgressive:t[e].scoreList[0],winBelief:t[e].scoreList[1],innovationRealism:t[e].scoreList[2],trustHelp:t[e].scoreList[3],respectEquality:t[e].scoreList[4],diligenceExcellence:t[e].scoreList[5],missionAccomplished:t[e].scoreList[6],globalView:t[e].scoreList[7],selfReflection:t[e].scoreList[8],confidence:t[e].confidenceLevel,status:t[e].state})}else g.Ay.error("获取评分列表失败,"+e.data.msg)})).catch((e=>{g.Ay.error("请求失败！",e)}))},q=e=>{u.current=e.current,V()},X=(0,o.Kh)({selectedRowKeys:[]}),J=e=>{X.selectedRowKeys=e},U=e=>{G.value=e.Evaluator,Y.value=e.department,te(e.userId),$.value=!0},D=e=>{"已确认"!==e.status?w(e.userId).then((t=>{200===t.data.code?(g.Ay.success("已驳回"+e.Evaluator+"的评分!"),V()):g.Ay.error("驳回失败"+t.data.msg)})).catch((e=>{g.Ay.error("请求失败！",e)})):g.Ay.warning("操作失败！您已确认"+e.Evaluator+"的打分，不可再驳回~")},Q=e=>{b(e.userId).then((t=>{200===t.data.code?(g.Ay.success("已确认"+e.Evaluator+"的评分! ^_^"),V()):g.Ay.error("确认失败，"+t.data.msg)})).catch((e=>{g.Ay.error("请求失败！",e)}))},M=()=>{0!==X.selectedRowKeys.length?x(X.selectedRowKeys).then((e=>{200===e.data.code?(g.Ay.success(`已确认${X.selectedRowKeys.length}位评估人的评分! ^_^`),X.selectedRowKeys=[],V()):g.Ay.error("操作失败，"+e.data.msg)})).catch((e=>{g.Ay.error("请求失败！"+e)})):g.Ay.warning("请先选择评估人！")},$=(0,o.KR)(!1),Z=(0,o.KR)([]),G=(0,o.KR)(""),Y=(0,o.KR)(""),ee=(0,o.KR)([{title:"被评估人",dataIndex:"assessor",key:"assessor",fixed:"left",align:"center",width:90},{title:"开放进取 (O)",dataIndex:"openProgressive",key:"openProgressive",align:"center"},{title:"打胜仗作为信仰 (W)",dataIndex:"winBelief",key:"winBelief",align:"center"},{title:"创新求实 (I)",dataIndex:"innovationRealism",key:"innovationRealism",align:"center"},{title:"信任互助 (H)",dataIndex:"trustHelp",key:"trustHelp",align:"center"},{title:"尊重平等 (R)",dataIndex:"respectEquality",key:"respectEquality",align:"center"},{title:"业精于勤 (D)",dataIndex:"diligenceExcellence",key:"diligenceExcellence",align:"center"},{title:"使命必达 (M)",dataIndex:"missionAccomplished",key:"missionAccomplished",align:"center"},{title:"五湖四海 (F)",dataIndex:"globalView",key:"globalView",align:"center"},{title:"坚持自省 (I)",dataIndex:"selfReflection",key:"selfReflection",align:"center"},{title:"总分",dataIndex:"totalScore",key:"totalScore",align:"center",width:80}]),te=e=>{Z.value=[],f(e).then((e=>{if(200===e.data.code){const t=e.data.data;for(let e=0;e<t.length;e++)Z.value.push({id:e,assessor:t[e].evaluatedName,openProgressive:t[e].scores[0],winBelief:t[e].scores[1],innovationRealism:t[e].scores[2],trustHelp:t[e].scores[3],respectEquality:t[e].scores[4],diligenceExcellence:t[e].scores[5],missionAccomplished:t[e].scores[6],globalView:t[e].scores[7],selfReflection:t[e].scores[8],totalScore:t[e].allScore})}else g.Ay.error("获取详情数据失败，"+e.data.msg)})).catch((e=>{g.Ay.error("请求失败！",e)}))},ae=e=>{$.value=!1},ne=(0,o.KR)(!1),le=(0,o.KR)({confidence:""}),re=(0,o.KR)(""),oe=e=>{le.value.confidence=e.confidence,re.value=e.userId,ne.value=!0},se=()=>{let e=le.value.confidence;null!==e&&""!==e?isNaN(e)?g.Ay.error("置信度必须是一个有效的数字！"):e<0||e>1?g.Ay.error("置信度必须在 0 到 1 之间！"):k(re.value,le.value.confidence).then((e=>{200===e.data.code?(g.Ay.success("设置成功！"),ne.value=!1,V()):g.Ay.error("设置失败！",e.data.msg)})).catch((e=>{g.Ay.error("请求失败！",e)})):g.Ay.error("请填写置信度！")},ie=()=>{ne.value=!1},ce=()=>{A().then((e=>{200===e.data.code?(g.Ay.success("操作成功!"),s.value=!1,V()):g.Ay.error("操作失败！"+e.data.msg)})).catch((e=>{g.Ay.error("请求失败！",e)}))};return(0,n.sV)((()=>{"3"===localStorage.getItem("userRole")&&(y(),V(),c()),H(),window.addEventListener("resize",H)})),(0,n.hi)((()=>{window.removeEventListener("resize",H)})),(e,t)=>{const i=(0,n.g2)("a-input"),c=(0,n.g2)("a-form-item"),g=(0,n.g2)("a-select-option"),m=(0,n.g2)("a-select"),y=(0,n.g2)("a-button"),v=(0,n.g2)("a-form"),f=(0,n.g2)("a-popconfirm"),k=(0,n.g2)("a-tag"),w=(0,n.g2)("a-table"),b=(0,n.g2)("a-modal"),x=(0,n.g2)("a-input-number"),A=(0,n.g2)("a-empty");return a.value?((0,n.uX)(),(0,n.CE)("div",I,[(0,n.Lk)("div",C,[(0,n.Lk)("div",_,[(0,n.bF)(v,{style:{display:"flex","align-items":"center"}},{default:(0,n.k6)((()=>[(0,n.bF)(c,{label:"评估人",style:{"margin-right":"20px",width:"200px"}},{default:(0,n.k6)((()=>[(0,n.bF)(i,{placeholder:"请输入姓名",value:d.name,"onUpdate:value":t[0]||(t[0]=e=>d.name=e),allowClear:!0},null,8,["value"])])),_:1}),(0,n.bF)(c,{label:"部门",style:{"margin-right":"20px",width:"200px"}},{default:(0,n.k6)((()=>[(0,n.bF)(m,{placeholder:"请选择部门",value:d.department,"onUpdate:value":t[1]||(t[1]=e=>d.department=e),allowClear:!0},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(p.value,(e=>((0,n.uX)(),(0,n.Wv)(g,{key:e,value:e},{default:(0,n.k6)((()=>[(0,n.eW)((0,l.v_)(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value"])])),_:1}),(0,n.bF)(c,{label:"状态",style:{"margin-right":"20px",width:"200px"}},{default:(0,n.k6)((()=>[(0,n.bF)(m,{placeholder:"请选择状态",value:d.status,"onUpdate:value":t[2]||(t[2]=e=>d.status=e),allowClear:!0},{default:(0,n.k6)((()=>[(0,n.bF)(g,{value:""},{default:(0,n.k6)((()=>t[7]||(t[7]=[(0,n.eW)("全部")]))),_:1}),(0,n.bF)(g,{value:"待确认"},{default:(0,n.k6)((()=>t[8]||(t[8]=[(0,n.eW)("待确认")]))),_:1}),(0,n.bF)(g,{value:"已确认"},{default:(0,n.k6)((()=>t[9]||(t[9]=[(0,n.eW)("已确认")]))),_:1})])),_:1},8,["value"])])),_:1}),(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(y,{type:"primary",onClick:(0,r.D$)(T,["prevent"]),class:"searchBtn"},{default:(0,n.k6)((()=>t[10]||(t[10]=[(0,n.eW)("搜索")]))),_:1})])),_:1})])),_:1})]),(0,n.Lk)("div",F,[(0,n.bF)(y,{type:"primary",onClick:M,style:{"margin-right":"10px"}},{icon:(0,n.k6)((()=>[(0,n.bF)((0,o.R1)(h))])),default:(0,n.k6)((()=>[t[11]||(t[11]=(0,n.eW)(" 批量确认 "))])),_:1}),(0,n.bF)(f,{placement:"bottomRight",title:"请再次检查是否所有成员的评分都已确认，若有未确认的评分，直接进入下一步后，将自动确认所有评分哦！进入下一环节后还需在<得分看板>将结果设置可见","ok-text":"确定","cancel-text":"取消",onConfirm:t[3]||(t[3]=e=>ce())},{default:(0,n.k6)((()=>[s.value?((0,n.uX)(),(0,n.Wv)(y,{key:0,type:"primary",style:{"background-color":"#68BBC4"}},{default:(0,n.k6)((()=>t[12]||(t[12]=[(0,n.eW)(" 进入下一环节 ")]))),_:1})):(0,n.Q3)("",!0)])),_:1}),s.value?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(y,{key:0,type:"primary",disabled:""},{default:(0,n.k6)((()=>t[13]||(t[13]=[(0,n.eW)(" 不在当前环节 ")]))),_:1}))])]),(0,n.Lk)("div",K,[(0,n.bF)(w,{columns:B.value,"data-source":N.value,pagination:u,"row-selection":{selectedRowKeys:X.selectedRowKeys,onChange:J},bordered:!0,scroll:{y:z.value},onChange:q,"row-key":"userId"},{emptyText:(0,n.k6)((()=>t[14]||(t[14]=[]))),status:(0,n.k6)((({text:e})=>["已确认"===e?((0,n.uX)(),(0,n.Wv)(k,{key:0,color:"green",style:{"margin-right":"0px"}},{default:(0,n.k6)((()=>t[15]||(t[15]=[(0,n.eW)("已确认")]))),_:1})):(0,n.Q3)("",!0),"待确认"===e?((0,n.uX)(),(0,n.Wv)(k,{key:1,color:"red",style:{"margin-right":"0px"}},{default:(0,n.k6)((()=>t[16]||(t[16]=[(0,n.eW)("待确认")]))),_:1})):(0,n.Q3)("",!0)])),action:(0,n.k6)((({record:e})=>[(0,n.Lk)("div",L,[(0,n.Lk)("span",{onClick:t=>U(e)},"查看详情",8,E),(0,n.Lk)("span",{onClick:t=>oe(e)},"设置置信度",8,P),(0,n.bF)(f,{title:"确定要驳回吗?","ok-text":"确定","cancel-text":"取消",onConfirm:t=>D(e)},{default:(0,n.k6)((()=>t[17]||(t[17]=[(0,n.Lk)("span",null,"驳回",-1)]))),_:2},1032,["onConfirm"]),(0,n.Lk)("span",{onClick:t=>Q(e)},"确认",8,S)])])),_:1},8,["columns","data-source","pagination","row-selection","scroll"])]),(0,n.bF)(b,{open:$.value,"onUpdate:open":t[4]||(t[4]=e=>$.value=e),title:"查看详情",onOk:ae,style:{width:"90vw"},class:"score-table"},{default:(0,n.k6)((()=>[(0,n.Lk)("span",O,[(0,n.Lk)("span",j,(0,l.v_)(G.value)+"（"+(0,l.v_)(Y.value)+"）的打分详情",1)]),(0,n.bF)(w,{columns:ee.value,"data-source":Z.value,pagination:!1,bordered:""},null,8,["columns","data-source"])])),_:1},8,["open"]),(0,n.bF)(b,{open:ne.value,"onUpdate:open":t[6]||(t[6]=e=>ne.value=e),title:"设置置信度",onOk:se,onCancel:ie},{default:(0,n.k6)((()=>[(0,n.bF)(x,{value:le.value.confidence,"onUpdate:value":t[5]||(t[5]=e=>le.value.confidence=e),style:{width:"100%"}},null,8,["value"])])),_:1},8,["open"])])):((0,n.uX)(),(0,n.CE)("div",W,[(0,n.bF)(A,{description:"您暂无权限查看该页面0~0"})]))}}},B=a(2965);const N=(0,B.A)(T,[["__scopeId","data-v-08a1d9e6"]]);var z=N}}]);
//# sourceMappingURL=410.9fa0e2b6.js.map