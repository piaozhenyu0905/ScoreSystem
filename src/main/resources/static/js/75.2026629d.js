"use strict";(self["webpackChunkscoring_system_front"]=self["webpackChunkscoring_system_front"]||[]).push([[75],{41:function(e,t,a){a.d(t,{AV:function(){return s},JQ:function(){return d},XD:function(){return o},_8:function(){return r},q6:function(){return l},yN:function(){return i}});var n=a(5857);const o=(e,t)=>new Promise(((a,o)=>{(0,n.A)({method:"get",url:"/api/todolist",headers:{"Content-Type":"application/json"},params:{pageNum:e,pageSize:t}}).then((e=>{a(e)})).catch((e=>{o(e.response)}))})),r=()=>new Promise(((e,t)=>{(0,n.A)({method:"get",url:"/api/findAll",headers:{"Content-Type":"application/json"}}).then((t=>{e(t)})).catch((e=>{t(e.response)}))})),l=e=>new Promise(((t,a)=>{let o={userIds:e};(0,n.A)({method:"post",url:"/api/add/evaluated",headers:{"Content-Type":"application/json"},data:JSON.stringify(o)}).then((e=>{t(e)})).catch((e=>{a(e.response)}))})),s=()=>new Promise(((e,t)=>{(0,n.A)({method:"get",url:"/api/find/assessor",headers:{"Content-Type":"application/json"}}).then((t=>{e(t)})).catch((e=>{t(e.response)}))})),d=()=>new Promise(((e,t)=>{(0,n.A)({method:"get",url:"/api/export/tick",headers:{"Content-Type":"application/json"},responseType:"blob"}).then((t=>{e(t)})).catch((e=>{t(e.response)}))})),i=()=>new Promise(((e,t)=>{(0,n.A)({method:"get",url:"/api/export/evaluatedInfo",headers:{"Content-Type":"application/json"},responseType:"blob"}).then((t=>{e(t)})).catch((e=>{t(e.response)}))}))},75:function(e,t,a){a.r(t),a.d(t,{default:function(){return S}});a(9138),a(1531),a(3678),a(4145);var n=a(7616),o=a(5929),r=a(3e3),l=a(1516),s=a(4720),d=a(41),i=a(543);a(9314);const c={class:"todoList-container"},u={class:"left"},p={class:"title"},g={key:0},y={class:"not-done"},m={key:1},h={class:"todoTable"},k={key:0},v={key:0},f={key:1},b=["onClick"],w={key:2},A=["onClick"],x={class:"right"},C={style:{"margin-top":"10px"}};var T={__name:"TodoList",setup(e){(0,n.sV)((()=>{F(),J(),_(),T(),window.addEventListener("resize",_),Y()}));const t=(0,r.KR)(!1),a=(0,r.KR)(),T=()=>{(0,i.Q)().then((e=>{if(200===e.data.code)for(let n=0;n<=e.data.data.evaluateStep.length-1;n++)1===e.data.data.evaluateStep[n].enable&&(a.value=n+1+"","1"===a.value&&(t.value=!0));else l.Ay.error("èŽ·å–å¤±è´¥ï¼"+e.data.msg)})).catch((e=>{console.log("èŽ·å–å¤±è´¥ï¼",e)}))};(0,n.hi)((()=>{window.removeEventListener("resize",_)}));const L=(0,r.KR)("60vh"),I=(0,s.rd)(),S=(0,r.Kh)({pageSize:12,current:1,showSizeChanger:!1,total:0,showTotal:(e,t)=>`æ€»å…± ${e} æ¡æ•°æ®`}),R=(0,r.KR)([{title:"åºå·",dataIndex:"index",key:"index",width:"10%",align:"center"},{title:"ä»»åŠ¡ç±»åž‹",dataIndex:"taskTag",key:"taskTag",width:"15%",align:"center"},{title:"ä»»åŠ¡è¯¦æƒ…",dataIndex:"taskDetail",key:"taskDetail",width:"30%",align:"center"},{title:"æäº¤æ—¶é—´",dataIndex:"submitTime",key:"submitTime",align:"center"},{title:"æ“ä½œ",key:"action",align:"center"}]),K=(0,r.KR)([]),_=()=>{const e=window.innerHeight,t=e-35-10;L.value=e<800?.63*t+"px":.7*t+"px"},E=(0,r.KR)(),F=()=>{K.value.splice(0,K.value.length),sessionStorage.getItem("currentIndex")&&(S.current=sessionStorage.getItem("currentIndex")),(0,d.XD)(S.current,S.pageSize).then((e=>{if(200===e.data.code){S.total=e.data.data.total,E.value=e.data.data.total,K.value=[];const t=e.data.data.data.filter((e=>0===e.operation));K.value.push(...t.map(((e,t)=>({key:e.id,index:S.current*S.pageSize-S.pageSize+t+1,taskTag:e.type,taskDetail:e.detail,submitTime:e.presentDate,operation:e.operation,evaluatedName:e.evaluatedName,department:e.department}))))}else l.Ay.error("èŽ·å–å¤±è´¥ï¼"+e.data.msg)})).catch((e=>{l.Ay.error("è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•ï¼")}))},X=e=>"æ·»åŠ è¯„ä¼°äººå®¡æ‰¹"===e?"cyan":"æ·»åŠ è¢«è¯„ä¼°äººå®¡æ‰¹"===e?"orange":"å‘¨è¾¹è¯„è®®"===e?"purple":"green",z=e=>{l.Ay.success("åŒæ„æˆåŠŸï¼")},N=e=>{S.current=Number(e.current),S.pageSize=e.pageSize,sessionStorage.setItem("currentIndex",S.current),F()},j=(0,r.KR)(!1),D=()=>{j.value=!0},W=e=>{const t=e.evaluatedName,a=e.department,n=e.key;sessionStorage.setItem("evaluatedName",t),sessionStorage.setItem("department",a),sessionStorage.setItem("todoListId",n),"0"===localStorage.getItem("userRole")?I.push({path:"/quesnaireEdit"}):I.push({path:"/quesnaireEditAd"})},P=(0,r.KR)(!1),Q=()=>{P.value=!0},U=(0,r.KR)(!1),$=()=>{U.value=!0},q=(0,r.KR)([]),O=(0,r.KR)([]),J=()=>{(0,d._8)().then((e=>{if(200===e.data.code){O.value=[];for(let t=0;t<=e.data.data.length-1;t++)O.value.push({value:e.data.data[t].name+"("+e.data.data[t].department+")",key:e.data.data[t].userId})}else l.Ay.error("èŽ·å–å¤±è´¥ï¼"+e.data.msg)})).catch((e=>{l.Ay.error("è¯·æ±‚å¤±è´¥ï¼"+e)}))},V=(0,r.KR)(!1),B=()=>{if(V.value)return void l.Ay.warning("æ­£åœ¨æäº¤ä¸­ï¼Œè¯·å‹¿é‡å¤æäº¤ï¼");V.value=!0;const e=q.value.map((e=>O.value.find((t=>t.value===e)).key));0!==e.length?e.length>3?l.Ay.warn("æœ€å¤šåªèƒ½é€‰æ‹©ä¸‰ä¸ªè¢«è¯„ä¼°äººå“¦ð–¦¹ð–¦¹ .áŸ.áŸ "):(0,d.q6)(e).then((e=>{200===e.data.code?(l.Ay.success("æ·»åŠ æˆåŠŸï¼"),q.value=[],Y(),F(),U.value=!1):l.Ay.error("æ·»åŠ å¤±è´¥ï¼"+e.data.msg)})).catch((e=>{l.Ay.error("è¯·æ±‚å¤±è´¥ï¼"+e)})).finally((()=>{V.value=!1})):l.Ay.warn("æ‚¨è¿˜æœªé€‰æ‹©è¢«è¯„ä¼°äººå“¦ð–¦¹ð–¦¹ .áŸ.áŸ ")},H=(0,r.KR)([{title:"åºå·",dataIndex:"index",key:"index",align:"center"},{title:"å§“å",dataIndex:"username",key:"username",align:"center"},{title:"éƒ¨é—¨",dataIndex:"department",key:"department",align:"center"}]),M=(0,r.KR)([]),Y=()=>{(0,d.AV)().then((e=>{if(200===e.data.code){M.value=[];for(let t=0;t<=e.data.data.length-1;t++)M.value.push({index:t+1,username:e.data.data[t].username,department:e.data.data[t].department})}else l.Ay.error("èŽ·å–å¤±è´¥ï¼"+e.data.msg)})).catch((e=>{l.Ay.error("è¯·æ±‚å¤±è´¥ï¼"+e)}))},G=()=>{const e=new Date,t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),n=e.getDate().toString().padStart(2,"0");return`${t}-${a}-${n}`},Z=()=>{(0,d.JQ)().then((e=>{if(e&&e.data){const t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a"),n=URL.createObjectURL(t),o=`æœ¬è½®å…¨éƒ¨æ‰“åˆ†æƒ…å†µ${G()}.xlsx`;a.href=n,a.download=o,a.click(),l.Ay.success("æœ¬è½®å…¨éƒ¨æ‰“åˆ†æƒ…å†µå¯¼å‡ºæˆåŠŸï¼")}else l.Ay.error("å¯¼å‡ºå¤±è´¥ï¼æœªçŸ¥é”™è¯¯")})).catch((e=>{console.error("è¯·æ±‚å¤±è´¥ï¼š",e),l.Ay.error("è¯·æ±‚å¤±è´¥ï¼")}))},ee=()=>{(0,d.yN)().then((e=>{if(e&&e.data){const t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=document.createElement("a"),n=URL.createObjectURL(t),o=`å¾…è¯„åˆ†åˆ—è¡¨${G()}.xlsx`;a.href=n,a.download=o,a.click(),l.Ay.success("å¾…è¯„åˆ†åˆ—è¡¨å¯¼å‡ºæˆåŠŸï¼")}else l.Ay.error("å¯¼å‡ºå¤±è´¥ï¼æœªçŸ¥é”™è¯¯")})).catch((e=>{console.error("è¯·æ±‚å¤±è´¥ï¼š",e),l.Ay.error("è¯·æ±‚å¤±è´¥ï¼")}))};return(e,a)=>{const r=(0,n.g2)("a-button"),l=(0,n.g2)("a-tag"),s=(0,n.g2)("a-divider"),d=(0,n.g2)("a-table"),i=(0,n.g2)("a-select"),T=(0,n.g2)("a-modal");return(0,n.uX)(),(0,n.CE)("div",c,[(0,n.Lk)("div",u,[(0,n.Lk)("div",p,[0!==E.value?((0,n.uX)(),(0,n.CE)("span",g,[a[2]||(a[2]=(0,n.eW)("æˆ‘çš„å¾…åŠžâ€‚")),(0,n.Lk)("span",y,"æœªå®Œæˆï¼š"+(0,o.v_)(E.value),1)])):((0,n.uX)(),(0,n.CE)("span",m,a[3]||(a[3]=[(0,n.eW)("æˆ‘çš„å¾…åŠžâ€‚"),(0,n.Lk)("span",{class:"all-done"},"å·²ç»å®Œæˆæ‰“åˆ†ä»»åŠ¡",-1)]))),(0,n.Lk)("span",null,[(0,n.bF)(r,{type:"primary",style:{"margin-right":"10px"},onClick:ee,disabled:t.value},{default:(0,n.k6)((()=>a[4]||(a[4]=[(0,n.eW)(" å¯¼å‡ºå¾…è¯„åˆ†åˆ—è¡¨ ")]))),_:1},8,["disabled"]),(0,n.bF)(r,{type:"primary",style:{"background-color":"#39ba06"},onClick:Z,disabled:t.value},{default:(0,n.k6)((()=>a[5]||(a[5]=[(0,n.eW)(" å¯¼å‡ºæ‰“åˆ†æƒ…å†µ ")]))),_:1},8,["disabled"])])]),(0,n.Lk)("div",h,[(0,n.bF)(d,{columns:R.value,"data-source":K.value,rowKey:e=>e.key,scroll:{y:L.value},pagination:S,bordered:!0,onChange:N},{bodyCell:(0,n.k6)((({column:e,record:t})=>["taskTag"===e.key?((0,n.uX)(),(0,n.CE)("span",k,[((0,n.uX)(),(0,n.Wv)(l,{key:t.taskTag,color:X(t.taskTag)},{default:(0,n.k6)((()=>[(0,n.eW)((0,o.v_)(t.taskTag),1)])),_:2},1032,["color"]))])):(0,n.Q3)("",!0),"action"===e.key?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},["æ·»åŠ è¯„ä¼°äººå®¡æ‰¹"===t.taskTag?((0,n.uX)(),(0,n.CE)("span",v,[(0,n.Lk)("a",{style:{color:"#0014b7","text-decoration":"underline"},onClick:Q},"æŸ¥çœ‹è¯¦æƒ…"),(0,n.bF)(s,{type:"vertical"}),(0,n.Lk)("a",{style:{color:"#bd3124","font-weight":"bold"},onClick:D},"æ‹’ç»")])):"æ·»åŠ è¢«è¯„ä¼°äººå®¡æ‰¹"===t.taskTag?((0,n.uX)(),(0,n.CE)("span",f,[(0,n.Lk)("a",{style:{color:"#3f9373","font-weight":"bold"},onClick:e=>z(t)},"åŒæ„",8,b),(0,n.bF)(s,{type:"vertical"}),(0,n.Lk)("a",{style:{color:"#bd3124","font-weight":"bold"},onClick:D},"æ‹’ç»")])):"å‘¨è¾¹è¯„è®®"===t.taskTag?((0,n.uX)(),(0,n.CE)("span",w,[(0,n.Lk)("a",{style:{color:"#3f9373","font-weight":"bold"},onClick:e=>W(t)},"è¿›å…¥è¯„è®®",8,A)])):(0,n.Q3)("",!0)],64)):(0,n.Q3)("",!0)])),_:1},8,["columns","data-source","rowKey","scroll","pagination"])])]),(0,n.Lk)("div",x,[(0,n.bF)(r,{type:"primary",onClick:$},{default:(0,n.k6)((()=>a[6]||(a[6]=[(0,n.eW)(" æˆ‘è¦è¯„ä¼° ")]))),_:1}),(0,n.Lk)("div",C,[(0,n.bF)(d,{columns:H.value,"data-source":M.value,bordered:!1,pagination:!1,scroll:{y:"60vh"}},null,8,["columns","data-source"])]),(0,n.bF)(T,{open:U.value,"onUpdate:open":a[1]||(a[1]=e=>U.value=e),title:"æ·»åŠ è¢«è¯„ä¼°äºº",onOk:B},{default:(0,n.k6)((()=>[a[7]||(a[7]=(0,n.Lk)("span",{style:{color:"#bd3124"}},"æ³¨ï¼šæ‚¨å¯ä»¥è‡ªä¸»é€‰æ‹©1-3ä¸ªè¦è¯„ä¼°çš„äºº",-1)),(0,n.bF)(i,{value:q.value,"onUpdate:value":a[0]||(a[0]=e=>q.value=e),options:O.value,mode:"multiple",placeholder:"è¯·é€‰æ‹©",style:{width:"100%"}},null,8,["value","options"])])),_:1},8,["open"])])])}}},L=a(3578);const I=(0,L.A)(T,[["__scopeId","data-v-57e49de9"]]);var S=I}}]);
//# sourceMappingURL=75.2026629d.js.map