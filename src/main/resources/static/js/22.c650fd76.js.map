{"version":3,"file":"js/22.c650fd76.js","mappings":"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","sources":["webpack://scoring_system_front/./src/page/admin/ActionLogAd.vue","webpack://scoring_system_front/./src/api/actionLog.js","webpack://scoring_system_front/./src/page/ordinary/ActionLog.vue","webpack://scoring_system_front/./src/page/ordinary/ActionLog.vue?9523"],"sourcesContent":["import script from \"./ActionLogAd.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ActionLogAd.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","import axios from \"axios\";\n\n// 获取操作日志\nconst getHistoryApi = () => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/find/history',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// 查看某次打分结果\nconst getScoreApi = (taskId) => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/find/score',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        params: {\n            taskId: taskId,\n        },\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\nexport{\n    getHistoryApi,\n    getScoreApi\n}","<!-- 普通用户--我的操作日志 -->\n<script setup>\nimport { onMounted, ref } from \"vue\"\nimport { CheckCircleOutlined } from '@ant-design/icons-vue'\nimport { notification } from 'ant-design-vue'\nimport { getHistoryApi, getScoreApi } from '@/api/actionLog'\nimport { message } from 'ant-design-vue'\n\nonMounted(() => {\n    getHistory()\n})\n\nconst openTable = ref(false)  // 默认弹窗关闭\nconst logIsNull = ref(true)\n// 打开弹窗函数\nconst showModal = () => {\n    openTable.value = true;\n};\n// 关闭弹窗函数\nconst closeModal = e => {\n    openTable.value = false;\n};\nconst timelineData = ref([])\n// 时间轴数据 \nconst getHistory = () => {\n    getHistoryApi().then(res => {\n        if (res.data.code === 200) {\n            // 清空 data.value，避免多次追加导致重复数据\n            timelineData.value = [];\n            for (let i = 0; i < res.data.data.data.length; i++) {\n                timelineData.value.push({\n                    assessorId: res.data.data.data[i].assessorId,\n                    assessorName: res.data.data.data[i].assessorName,\n                    assessorTime: res.data.data.data[i].assessorTime,\n                    isReject: res.data.data.data[i].isReject,\n                    taskId: res.data.data.data[i].taskId,\n                    rejectReason: res.data.data.data[i].rejectReason\n                })\n            }\n            if (timelineData.value.length === 0) {\n                logIsNull.value = true\n            } else {\n                logIsNull.value = false\n            }\n        } else {\n            // 处理非成功响应\n            message.error(\"获取失败！\" + res.data.msg);\n        }\n    })\n        .catch(err => {\n            // 捕获并处理请求错误\n            message.error(\"请求失败，请稍后重试！\");\n        });\n}\n// 定义弹窗中的姓名和时间\nconst assessorNameTable = ref('ceshi')\nconst assessorTimeTable = ref('2024-10-01')\n// 定义表格数据\nconst columns = [\n    {\n        name: 'Dimension',\n        dataIndex: 'dimension',\n        key: 'dimension',\n        fixed: 'left'\n    },\n    {\n        title: '成为榜样（5分）',\n        dataIndex: 'beExample',\n        key: 'beExample',\n        align: 'center',\n    },\n    {\n        title: '成为习惯（4.5分）',\n        dataIndex: 'beHabit',\n        key: 'beHabit',\n        align: 'center',\n    },\n    {\n        title: '经常正感知（4分）',\n        key: 'oftenPositive',\n        dataIndex: 'oftenPositive',\n        align: 'center',\n    },\n    {\n        title: '偶尔正感知（3.5分）',\n        dataIndex: 'occasionalPositive',\n        key: 'occasionalPositive',\n        align: 'center',\n    },\n    {\n        title: '无感知（3分）',\n        dataIndex: 'noPerception',\n        key: 'noPerception',\n        align: 'center',\n    },\n    {\n        title: '偶尔负感知（2.5分）',\n        key: 'occasionalNegative',\n        dataIndex: 'occasionalNegative',\n        align: 'center',\n    },\n    {\n        title: '经常负感知（2分）',\n        key: 'oftenNegative',\n        dataIndex: 'oftenNegative',\n        align: 'center',\n    }\n];\nconst data = ref([]);\n// 调用api-获取对应评议记录\nconst handleTimeline = (item) => {\n    // 若为被驳回记录，则弹出提示\n    if (item.isReject === true) {\n        openNotificationWithIcon('warning', '记录被驳回，请注意！');\n    }\n    // 若为评议记录，则弹出弹窗，查看打分结果\n    else {\n        // 更新被评估人姓名和时间\n        assessorNameTable.value = item.assessorName;\n        assessorTimeTable.value = item.assessorTime;\n\n        // 调用 API 获取评分数据\n        getScoreApi(item.taskId)\n            .then(res => {\n                if (res.data.code === 200) {\n                    // 清空 data 数组\n                    data.value.length = 0;\n\n                    // 定义基础数据结构\n                    const baseData = [\n                        { key: '1', dimension: '思想上：开放进取（O）' },\n                        { key: '2', dimension: '作风上：把打胜仗作为信仰（W）' },\n                        { key: '3', dimension: '业务上：创实求新（I）' },\n                        { key: '4', dimension: '工作中：信任互助（H）' },\n                        { key: '5', dimension: '员工间：尊重平等（R）' },\n                        { key: '6', dimension: '行为上：业精于勤（D）' },\n                        { key: '7', dimension: '执行力：使命必达（M）' },\n                        { key: '8', dimension: '团队上：五湖四海（F）' },\n                        { key: '9', dimension: '成长上：坚持自省（I）' },\n                    ];\n\n                    // 定义反向映射的分数到字段的映射\n                    const scoreMap = {\n                        5: 'beExample',         // 0 -> 'beExample'\n                        4.5: 'beHabit',         // 1 -> 'beHabit'\n                        4: 'oftenPositive',     // 2 -> 'oftenPositive'\n                        3.5: 'occasionalPositive',  // 3 -> 'occasionalPositive'\n                        3: 'noPerception',      // 4 -> 'noPerception'\n                        2.5: 'occasionalNegative', // 5 -> 'occasionalNegative'\n                        2: 'oftenNegative'      // 6 -> 'oftenNegative'\n                    };\n\n                    // 遍历 scores 并更新 data\n                    res.data.data.scores.forEach((score, index) => {\n                        // 初始化所有字段为 \"0\"\n                        const scoreFields = {\n                            beExample: '0',\n                            beHabit: '0',\n                            oftenPositive: '0',\n                            occasionalPositive: '0',\n                            noPerception: '0',\n                            occasionalNegative: '0',\n                            oftenNegative: '0',\n                        };\n\n                        // 查找反向映射的字段\n                        const field = scoreMap[score];\n                        if (field) {\n                            scoreFields[field] = '1'; // 如果找到了对应字段，将其设置为 \"1\"\n                        }\n\n                        // 将数据格式化并追加到 data 中\n                        data.value.push({\n                            ...baseData[index], // 保留 key 和 dimension\n                            ...scoreFields,     // 动态生成的字段\n                        });\n                    });\n\n                } else {\n                    // 处理非成功响应\n                    message.error(\"获取失败！\" + res.data.msg);\n                }\n            })\n            .catch(err => {\n                // 捕获并处理请求错误\n                console.error('请求出错:', err);\n                message.error(\"请求失败，请稍后重试！\");\n            });\n\n        // 显示弹窗\n        showModal();\n    }\n};\n// 定义弹窗\nconst openNotificationWithIcon = type => {\n    notification[type]({\n        message: '提示',\n        description:\n            '请到 <我的待办> 页面重新评议，若已重新评议，请忽略本提示 (˶˚ ᗨ ˚˶) ~',\n    });\n};\n</script>\n\n<template>\n    <div class=\"content-title\">\n        <span>我的操作日志</span>\n    </div>\n    <div class=\"content-log\">\n        <a-empty v-if=\"logIsNull\" class=\"no-data\"/>\n        <a-timeline>\n            <a-timeline-item v-for=\"item in timelineData\" :key=\"item.assessorName\"\n                :color=\"item.isReject ? 'red' : '#1677FF'\" class=\"timeline-item\" @click=\"handleTimeline(item)\">\n                <!-- 若为评议记录 -->\n                <template v-if=\"!item.isReject\">\n                    <span class=\"timeline-text\">\n                        您完成了对 <span style=\"font-weight: bold;\">{{ item.assessorName }}</span> 的周边评议 <span\n                            style=\"color: grey;\">/ {{ item.assessorTime }}</span>\n                    </span>\n                </template>\n                <!-- 若为被驳回记录 -->\n                <template v-else>\n                    <span class=\"timeline-text\">\n                        您有周边评议被打回，请重新评议(驳回理由：{{ item.rejectReason }}) <span style=\"color: grey;\">/ {{ item.assessorTime }}</span>\n                    </span>\n                </template>\n            </a-timeline-item>\n        </a-timeline>\n        <a-modal v-model:open=\"openTable\" title=\"查看打分记录\" @ok=\"closeModal\" style=\"width: 90vw;\" class=\"score-table\">\n            <span style=\"padding: 5px 5px 0px 5px;\">\n                <span style=\"color: #3894FF;\">您当前的评估对象为：</span><span>{{ assessorNameTable }}</span><span\n                    style=\"color: #3894FF;\">&emsp13;/\n                    评估时间：</span><span>{{ assessorTimeTable }}</span>\n            </span>\n            <a-table :columns=\"columns\" :data-source=\"data\" :pagination=\"false\" bordered>\n                <template #bodyCell=\"{ column, text }\">\n                    <!-- 第一列显示原始文本 -->\n                    <template v-if=\"column.dataIndex === 'dimension'\">\n                        {{ text }}\n                    </template>\n                    <!-- 第二列及以后，当值为1时显示绿色勾勾图标 -->\n                    <template v-else-if=\"text === '1'\">\n                        <CheckCircleOutlined style=\"font-size: 20px;\" />\n                    </template>\n                    <template v-else>\n                        <span></span>\n                    </template>\n                </template>\n            </a-table>\n        </a-modal>\n    </div>\n</template>\n\n<style lang=\"less\" scoped>\n.content-title {\n    margin: 10px 10px 10px 10px;\n\n    span {\n        display: block;\n        font-size: 16px;\n        font-weight: bold;\n        margin-bottom: 15px;\n    }\n}\n\n.content-log {\n    margin: 10px 10px 0px 10px;\n    padding: 20px 20px 0px 20px;\n    background-color: #e6f7ff; // 浅蓝色背景\n    border-top: 1px dashed #3a8ee6; // 边框为蓝色虚线\n    min-height: 75vh;\n    max-height: 75vh; // 设置页面最大高度\n    overflow-y: auto; // 当达到最大高度时出现滚动条\n\n    .no-data {\n        color: grey;\n        margin-top: 150px;\n    }\n\n    .timeline-item {\n        cursor: pointer;\n\n        .timeline-text {\n            padding: 7px 0px;\n            border-radius: 5px;\n            transition: background-color 0.3s ease;\n        }\n\n        .timeline-text:hover {\n            background-color: #d1e7f7;\n            /* 悬停时背景色 */\n        }\n    }\n\n}\n\n.score-table {\n    span {\n        display: inline-block;\n        font-weight: bold;\n        margin-bottom: 5px;\n        background-color: #e6f7ff; // 浅蓝色背景\n    }\n}\n\n::v-deep .ant-table-tbody>tr>td {\n    padding: 10px !important;\n}\n\n/* 定制滚动条 */\n.content-log::-webkit-scrollbar {\n    width: 6px;\n    /* 滚动条宽度，调整为更细 */\n}\n\n/* 滚动条轨道 */\n.content-log::-webkit-scrollbar-track {\n    background-color: transparent;\n    /* 轨道颜色保持默认 */\n}\n\n/* 滚动条滑块 */\n.content-log::-webkit-scrollbar-thumb {\n    background-color: darkgrey;\n    /* 滚动条滑块颜色保持默认 */\n    border-radius: 10px;\n    /* 滚动条滑块的圆角 */\n}\n\n/* 滚动条滑块悬停时 */\n.content-log::-webkit-scrollbar-thumb:hover {\n    background-color: #555;\n    /* 滚动条滑块悬停时的颜色 */\n}\n\n/* Firefox 特定样式 */\n.content-log {\n    scrollbar-width: thin;\n    /* 滚动条的宽度 */\n    scrollbar-color: darkgrey transparent;\n    /* 滚动条滑块和轨道的颜色，保持默认 */\n}\n</style>","import script from \"./ActionLog.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ActionLog.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ActionLog.vue?vue&type=style&index=0&id=45075533&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.10_webpack@5.95.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-45075533\"]])\n\nexport default __exports__"],"names":["__exports__","getHistoryApi","Promise","resolve","reject","axios","method","url","headers","then","response","catch","error","getScoreApi","taskId","params","onMounted","getHistory","openTable","ref","logIsNull","showModal","value","closeModal","e","timelineData","res","data","code","i","length","push","assessorId","assessorName","assessorTime","isReject","rejectReason","message","msg","err","assessorNameTable","assessorTimeTable","columns","name","dataIndex","key","fixed","title","align","handleTimeline","item","openNotificationWithIcon","baseData","dimension","scoreMap","scores","forEach","score","index","scoreFields","beExample","beHabit","oftenPositive","occasionalPositive","noPerception","occasionalNegative","oftenNegative","field","console","type","notification","description"],"sourceRoot":""}