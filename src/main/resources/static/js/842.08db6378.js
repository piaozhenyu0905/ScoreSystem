"use strict";(self["webpackChunkscoring_system_front"]=self["webpackChunkscoring_system_front"]||[]).push([[842],{6645:function(e,a,l){l.d(a,{Ju:function(){return u},Pb:function(){return n},RK:function(){return r},aJ:function(){return s}});var t=l(5857);const r=()=>new Promise(((e,a)=>{(0,t.A)({method:"get",url:"/api/basicInfo",headers:{"Content-Type":"application/json"}}).then((a=>{e(a)})).catch((e=>{a(e.response)}))})),u=(e,a)=>new Promise(((l,r)=>{let u={oldPassword:e,newPassword:a};(0,t.A)({method:"post",url:"/api/update/password",headers:{"Content-Type":"application/json"},data:JSON.stringify(u)}).then((e=>{l(e)})).catch((e=>{r(e.response)}))})),n=(e,a)=>new Promise(((l,r)=>{let u={id:e.id,name:e.name,username:e.username,workNum:e.workNum,department:e.department,supervisor1:e.supervisor1,supervisor2:e.supervisor2,supervisor3:e.supervisor3,hr:e.hr,superAdmin:e.superAdmin,firstAdmin:e.firstAdmin,secondAdmin:e.secondAdmin,hireDate:a,residence:e.residence,phoneNumber:e.phoneNumber,email:e.email,businessType:e.businessType,lxyz:e.lxyz,role:e.role,password:e.password};(0,t.A)({method:"post",url:"/api/update/selfInfo",headers:{"Content-Type":"application/json"},data:JSON.stringify(u)}).then((e=>{l(e)})).catch((e=>{r(e.response)}))})),s=(e,a)=>new Promise(((l,r)=>{let u={id:e.id,name:e.name,username:e.username,workNum:e.jobNumber,department:e.department,hireDate:a,phoneNumber:e.phone,email:e.email};(0,t.A)({method:"post",url:"/api/update/selfInfo",headers:{"Content-Type":"application/json"},data:JSON.stringify(u)}).then((e=>{l(e)})).catch((e=>{r(e.response)}))}))},4945:function(e,a,l){l.d(a,{JZ:function(){return u},aq:function(){return d},lc:function(){return n},sv:function(){return r},tq:function(){return s}});var t=l(5857);const r=(e,a,l,r,u)=>new Promise(((n,s)=>{let d={pageNum:e,pageSize:a,department:l,role:r,username:u};(0,t.A)({method:"post",url:"/api/basicInfos",headers:{"Content-Type":"application/json"},data:JSON.stringify(d)}).then((e=>{n(e)})).catch((e=>{s(e.response)}))})),u=()=>new Promise(((e,a)=>{(0,t.A)({method:"post",url:"/api/departments",headers:{"Content-Type":"application/json"}}).then((a=>{e(a)})).catch((e=>{a(e.response)}))})),n=e=>new Promise(((a,l)=>{(0,t.A)({method:"delete",url:"/api/delete/user",headers:{"Content-Type":"application/json"},params:{id:e}}).then((e=>{a(e)})).catch((e=>{l(e.response)}))})),s=e=>new Promise(((a,l)=>{let r=new FormData;r.append("file",e),(0,t.A)({method:"post",url:"/api/upload",headers:{"Content-Type":"multipart/form-data"},data:r}).then((e=>{a(e)})).catch((e=>{l(e.response)}))})),d=e=>new Promise(((a,l)=>{let r={ids:e};(0,t.A)({method:"delete",url:"/api/delete/users",headers:{"Content-Type":"application/json"},data:JSON.stringify(r)}).then((e=>{a(e)})).catch((e=>{l(e.response)}))}))},9842:function(e,a,l){l.r(a),l.d(a,{default:function(){return N}});var t=l(5115),r=(l(9138),l(9650)),u=l(3771),n=l(9675),s=l(3369),d=l.n(s),o=l(6645),i=l(4945),p=l(7123),v=l(2364);const c={class:"container"},m={class:"password-edit"},b={class:"password-header"},h={class:"password-form"},f={class:"personal-info-edit"},k={class:"info-header"},w={class:"personal-info-form"};var _={__name:"PersonalInfoEdit",setup(e){(0,t.sV)((()=>{P(),y()}));const a=(0,p.rd)(),l=(0,n.KR)({oldPassword:"",newPassword1:"",newPassword2:""}),s=(0,n.KR)({name:"",jobNumber:"",department:"",phone:"",email:"",entry_time:d()("2023-01-01"),supervisor1:"",supervisor2:"",supervisor3:"",hr:"",manager1:"",manager2:"",manager3:"",hrbp:"",role:""}),_=(0,n.KR)(!0),g=()=>{_.value=!_.value},F=(0,n.KR)(["部门a","部门b"]),y=()=>{(0,i.JZ)().then((e=>{if(200===e.data.code){F.value=[];for(let a=0;a<e.data.data.length;a++)F.value.push(e.data.data[a])}else u.Ay.error("获取失败！",e.data.msg)})).catch((e=>{u.Ay.error("请求失败！",e)}))},P=()=>{(0,o.RK)().then((e=>{if(200===e.data.code){s.value.id=e.data.data.id,s.value.name=e.data.data.name,s.value.username=e.data.data.username,s.value.jobNumber=e.data.data.workNum,s.value.department=e.data.data.department,s.value.phone=e.data.data.phoneNumber,s.value.email=e.data.data.email,s.value.entry_time=d()(e.data.data.hireDate),s.value.supervisor1=e.data.data.supervisor1,s.value.supervisor2=e.data.data.supervisor2,s.value.supervisor3=e.data.data.supervisor3,s.value.hr=e.data.data.hr,s.value.manager1=e.data.data.supervisorName1,s.value.manager2=e.data.data.supervisorName2,s.value.manager3=e.data.data.supervisorName3,s.value.hrbp=e.data.data.hrName,s.value.role=e.data.data.role;const a={0:"普通用户",1:"一级管理员",2:"二级管理员",3:"超级管理员"};s.value.role=a[e.data.data.role]||"未知角色"}else u.Ay.error("获取个人信息失败！"+e.data.msg)})).catch((e=>{u.Ay.error("请求失败！"+e)}))},A=()=>{""!==l.value.oldPassword&&""!==l.value.newPassword1&&""!==l.value.newPassword2?l.value.newPassword1===l.value.newPassword2?(0,o.Ju)(l.value.oldPassword,l.value.newPassword1).then((e=>{200===e.data.code?(u.Ay.success("修改密码成功！请重新登录~"),_.value=!0,l.value.oldPassword="",l.value.newPassword1="",l.value.newPassword2="",j()):u.Ay.error("修改失败！"+e.data.msg)})).catch((e=>{u.Ay.error("请求失败！"+e)})):u.Ay.error("两次新密码输入不一致！"):u.Ay.warning("请输入密码！")},N=(0,n.KR)(!0),C=()=>{N.value=!N.value},U=()=>{if(""===s.value.name||""===s.value.email||""===s.value.id||""===s.value.entry_time||""===s.value.department||""===s.value.manager||""===s.value.phone||""===s.value.role)u.Ay.warning("请输入完整信息！");else{const e=s.value,a=e.entry_time.$d,l=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),r=String(a.getDate()).padStart(2,"0"),n=`${l}-${t}-${r}`;(0,o.aJ)(e,n).then((e=>{200===e.data.code?(u.Ay.success("修改成功！^_^"),P(),N.value=!0):u.Ay.error("修改失败！",e.data.msg)})).catch((e=>{console.log(e)}))}},j=()=>{(0,v.PZ)().then((e=>{200===e.data.code&&(a.push({path:"/"}),u.Ay.success("您已退出登录！"))})).catch((e=>{403===e.data.code?(a.push({path:"/"}),u.Ay.error("登录信息已失效，请重新登录！")):console.log("退出登录失败！",e)}))};return(e,a)=>{const u=(0,t.g2)("a-button"),n=(0,t.g2)("a-input"),d=(0,t.g2)("a-form-item"),o=(0,t.g2)("a-col"),i=(0,t.g2)("a-row"),p=(0,t.g2)("a-form"),v=(0,t.g2)("a-select-option"),y=(0,t.g2)("a-select"),P=(0,t.g2)("a-date-picker");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.Lk)("div",m,[(0,t.Lk)("div",b,[a[15]||(a[15]=(0,t.Lk)("span",{class:"title"},"修改密码",-1)),(0,t.bF)(u,{type:"primary",ghost:"",class:"right-align",onClick:g},{default:(0,t.k6)((()=>a[14]||(a[14]=[(0,t.eW)("修改")]))),_:1})]),(0,t.Lk)("div",h,[(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.bF)(i,{gutter:72},{default:(0,t.k6)((()=>[(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"旧密码"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:_.value,placeholder:"请输入旧密码",value:l.value.oldPassword,"onUpdate:value":a[0]||(a[0]=e=>l.value.oldPassword=e)},null,8,["disabled","value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"新密码"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:_.value,placeholder:"请输入新密码",value:l.value.newPassword1,"onUpdate:value":a[1]||(a[1]=e=>l.value.newPassword1=e)},null,8,["disabled","value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"确认密码"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:_.value,placeholder:"请确认新密码",value:l.value.newPassword2,"onUpdate:value":a[2]||(a[2]=e=>l.value.newPassword2=e)},null,8,["disabled","value"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(d,null,{default:(0,t.k6)((()=>[_.value?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(u,{key:0,type:"primary",class:"center-button",onClick:A},{default:(0,t.k6)((()=>a[16]||(a[16]=[(0,t.eW)("提交")]))),_:1}))])),_:1})])),_:1})])]),(0,t.Lk)("div",f,[(0,t.Lk)("div",k,[a[18]||(a[18]=(0,t.Lk)("span",{class:"title"},"维护个人信息",-1)),(0,t.bF)(u,{type:"primary",ghost:"",class:"right-align",onClick:C},{default:(0,t.k6)((()=>a[17]||(a[17]=[(0,t.eW)("修改")]))),_:1})]),(0,t.Lk)("div",w,[(0,t.bF)(p,null,{default:(0,t.k6)((()=>[(0,t.bF)(i,{gutter:72},{default:(0,t.k6)((()=>[(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"姓名"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:N.value,placeholder:"请输入姓名",value:s.value.name,"onUpdate:value":a[3]||(a[3]=e=>s.value.name=e)},null,8,["disabled","value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"工号"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:N.value,placeholder:"请输入工号",value:s.value.jobNumber,"onUpdate:value":a[4]||(a[4]=e=>s.value.jobNumber=e)},null,8,["disabled","value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"部门"},{default:(0,t.k6)((()=>[(0,t.bF)(y,{disabled:N.value,placeholder:"请输入部门",value:s.value.department,"onUpdate:value":a[5]||(a[5]=e=>s.value.department=e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(F.value,(e=>((0,t.uX)(),(0,t.Wv)(v,{key:e,value:e},{default:(0,t.k6)((()=>[(0,t.eW)((0,r.v_)(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["disabled","value"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(i,{gutter:72},{default:(0,t.k6)((()=>[(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"手机号"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:N.value,placeholder:"请输入手机号",value:s.value.phone,"onUpdate:value":a[6]||(a[6]=e=>s.value.phone=e)},null,8,["disabled","value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"邮箱"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{disabled:N.value,placeholder:"请输入邮箱",value:s.value.email,"onUpdate:value":a[7]||(a[7]=e=>s.value.email=e)},null,8,["disabled","value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"入职时间"},{default:(0,t.k6)((()=>[(0,t.bF)(P,{style:{width:"100%"},disabled:N.value,placeholder:"请选择入职时间",value:s.value.entry_time,"onUpdate:value":a[8]||(a[8]=e=>s.value.entry_time=e)},null,8,["disabled","value"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(i,{gutter:72},{default:(0,t.k6)((()=>[(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"主管1"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{placeholder:"",value:s.value.manager1,"onUpdate:value":a[9]||(a[9]=e=>s.value.manager1=e),disabled:""},null,8,["value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"主管2"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{placeholder:"",value:s.value.manager2,"onUpdate:value":a[10]||(a[10]=e=>s.value.manager2=e),disabled:""},null,8,["value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"主管3"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{placeholder:"",value:s.value.manager3,"onUpdate:value":a[11]||(a[11]=e=>s.value.manager3=e),disabled:""},null,8,["value"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(i,{gutter:72},{default:(0,t.k6)((()=>[(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"HRBP"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{placeholder:"",value:s.value.hrbp,"onUpdate:value":a[12]||(a[12]=e=>s.value.hrbp=e),disabled:""},null,8,["value"])])),_:1})])),_:1}),(0,t.bF)(o,{span:8},{default:(0,t.k6)((()=>[(0,t.bF)(d,{label:"系统角色"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{placeholder:"请选择系统角色",value:s.value.role,"onUpdate:value":a[13]||(a[13]=e=>s.value.role=e),disabled:""},null,8,["value"])])),_:1})])),_:1})])),_:1}),(0,t.bF)(d,null,{default:(0,t.k6)((()=>[N.value?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.Wv)(u,{key:0,type:"primary",class:"center-button",onClick:U},{default:(0,t.k6)((()=>a[19]||(a[19]=[(0,t.eW)("提交")]))),_:1}))])),_:1})])),_:1})])])])}}},g=l(2965);const F=(0,g.A)(_,[["__scopeId","data-v-79aa1c7f"]]);var y=F,P={__name:"PersonalInfo",setup(e){return(e,a)=>((0,t.uX)(),(0,t.Wv)(y))}};const A=P;var N=A}}]);
//# sourceMappingURL=842.08db6378.js.map