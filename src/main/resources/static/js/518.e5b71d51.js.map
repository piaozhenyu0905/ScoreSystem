{"version":3,"file":"js/518.e5b71d51.js","mappings":"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","sources":["webpack://scoring_system_front/./src/api/todoList.js","webpack://scoring_system_front/./src/page/ordinary/TodoList.vue","webpack://scoring_system_front/./src/page/ordinary/TodoList.vue?bdb3"],"sourcesContent":["import axios from \"axios\";\n\n//è·å–è¯¥æ—¶é—´æ®µå†…çš„æ‰§è¡Œæƒ…å†µæ•°æ®\nconst getTodoListApi = (pageNum, pageSize) => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/todolist',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        params: {\n            pageNum: pageNum,\n            pageSize: pageSize\n        },\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n//è·å–äººå‘˜åˆ—è¡¨\nconst getUserListApi = () => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/findAll',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        }\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n//æäº¤é€‰æ‹©çš„è¢«è¯„ä¼°äºº\nconst getEvaluatedListApi = (userIds) => new Promise((resolve, reject) =>{\n    let data = {\n        userIds: userIds\n    };\n    axios({\n        method:'post',\n        url:'/api/add/evaluated',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n      data: JSON.stringify(data),\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// è·å–å½“å‰éœ€è¦æ‰“åˆ†çš„äººï¼ˆå³æˆ‘æ˜¯è°çš„è‡ªä¸»è¯„ä¼°äººï¼‰\nconst getAssessorApi = () => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/find/assessor',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        }\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// å¯¼å‡ºæˆ‘çš„æ‰“åˆ†æ•°æ®\nconst getExportSelfDataApi = () => new Promise((resolve, reject) =>{\n    axios({ \n        method:'get',\n        url:'/api/export/tick',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        responseType: 'blob'  // è®¾ç½®å“åº”ç±»å‹ä¸º blobï¼Œè¡¨ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// å¯¼å‡ºå¾…è¯„åˆ†åˆ—è¡¨\nconst getExportEvaluatedInfoApi = () => new Promise((resolve, reject) =>{\n    axios({ \n        method:'get',\n        url:'/api/export/evaluatedInfo',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        responseType: 'blob'  // è®¾ç½®å“åº”ç±»å‹ä¸º blobï¼Œè¡¨ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\nexport{\n    getTodoListApi,\n    getUserListApi,\n    getEvaluatedListApi,\n    getAssessorApi,\n    getExportSelfDataApi,\n    getExportEvaluatedInfoApi\n}","<!-- æ™®é€šç”¨æˆ·--æˆ‘çš„å¾…åŠ -->\n<script setup>\nimport { ref, reactive, onMounted, onUnmounted } from \"vue\";\n// import { FormOutlined } from '@ant-design/icons-vue';\nimport { message } from \"ant-design-vue\";\nimport { useRouter } from \"vue-router\";\nimport {\n  getTodoListApi,\n  getUserListApi,\n  getEvaluatedListApi,\n  getAssessorApi,\n  getExportSelfDataApi,\n  getExportEvaluatedInfoApi\n} from \"@/api/todoList\";\nimport { getStepTimeApi } from \"@/api/scoreTimeSet\"\nimport { notification } from \"ant-design-vue\";\n\nonMounted(() => {\n  getTodoList();\n  getUserList();\n  updateScrollHeight();\n  getStepTime();\n  window.addEventListener(\"resize\", updateScrollHeight);\n\n  getAssessor();\n}); \n\n// è·å–å½“å‰è¯„ä¼°è¿›åº¦\nconst isVisible = ref(false)\nconst currentSession = ref()\nconst getStepTime = () => {\n  getStepTimeApi()\n    .then(res => {\n      if (res.data.code === 200) {\n        for (let i = 0; i <= res.data.data.evaluateStep.length - 1; i++) {\n          if (res.data.data.evaluateStep[i].enable === 1) {\n            currentSession.value = i + 1 + '';\n            if (currentSession.value === '1') {\n              isVisible.value = true\n            }\n          }\n        }\n      } else {\n        message.error('è·å–å¤±è´¥ï¼' + res.data.msg)\n      }\n    })\n    .catch(err => {\n      console.log('è·å–å¤±è´¥ï¼', err);\n    });\n};\n\n// è¿›å…¥é¡µé¢æç¤ºå¯æ·»åŠ â€œæˆ‘è¦è¯„ä¼°â€\nconst openNotificationWithIcon = (type, message) => {\n  notification[type]({\n    message: \"å°æç¤º\",\n    description: message,\n    duration: 300, // è®¾ç½®æŒç»­æ—¶é—´ä¸º nullï¼Œè¡¨ç¤ºé€šçŸ¥ä¸è‡ªåŠ¨å…³é—­\n    placement: \"top\", // è®¾ç½®ä½ç½®ä¸ºé¡¶éƒ¨å±…ä¸­\n    style: {\n      fontSize: \"18px\", // ç›´æ¥ä¿®æ”¹å­—ä½“å¤§å°\n    },\n  });\n};\n\n// åœ¨ç»„ä»¶å¸è½½æ—¶ç§»é™¤äº‹ä»¶ç›‘å¬\nonUnmounted(() => {\n  window.removeEventListener(\"resize\", updateScrollHeight);\n});\n\nconst scrollHeight = ref(\"60vh\"); // å®šä¹‰æ»šåŠ¨åŒºåŸŸé«˜åº¦\nconst router = useRouter();\nconst pagination = reactive({\n  // è¡¨æ ¼é¡µç ç›¸å…³è®¾ç½®\n  pageSize: 12, //æ¯é¡µæœ€å¤šæ¡ç›®æ•°\n  current: 1, //å½“å‰é¡µç \n  showSizeChanger: false,\n  total: 0, //æ€»æ¡ç›®æ•°\n  showTotal: (total, range) => `æ€»å…± ${total} æ¡æ•°æ®`, // åœ¨è¿™é‡Œå®šä¹‰æ˜¾ç¤ºæ€»æ•°æ®é‡çš„æ ¼å¼\n});\nconst columns = ref([\n  {\n    title: \"åºå·\",\n    dataIndex: \"index\",\n    key: \"index\",\n    width: \"10%\",\n    align: \"center\",\n  },\n  {\n    title: \"ä»»åŠ¡ç±»å‹\",\n    dataIndex: \"taskTag\",\n    key: \"taskTag\",\n    width: \"15%\",\n    align: \"center\",\n  },\n  {\n    title: \"ä»»åŠ¡è¯¦æƒ…\",\n    dataIndex: \"taskDetail\",\n    key: \"taskDetail\",\n    width: \"30%\",\n    align: \"center\",\n  },\n  {\n    title: \"æäº¤æ—¶é—´\",\n    dataIndex: \"submitTime\",\n    key: \"submitTime\",\n    align: \"center\",\n  },\n  {\n    title: \"æ“ä½œ\",\n    key: \"action\",\n    align: \"center\",\n  },\n]);\nconst data = ref([]);\n\n// åŠ¨æ€æ›´æ–°é«˜åº¦\nconst updateScrollHeight = () => {\n  const screenHeight = window.innerHeight;\n  const containerHeight = screenHeight - 35 - 10; // å‡è®¾çˆ¶å®¹å™¨éœ€è¦å‡å»å›ºå®šçš„åç§»é‡\n  if (screenHeight < 800) {\n    scrollHeight.value = `${containerHeight * 0.63}px`; // å°å±å¹•é«˜åº¦ä¸º 50%\n  } else {\n    scrollHeight.value = `${containerHeight * 0.7}px`; // å¤§å±å¹•é«˜åº¦ä¸º 80%\n  }\n};\n// å¾…åŠå®Œæˆè¿›åº¦ç›¸å…³é…ç½®\nconst notDone = ref()\n// è°ƒç”¨api-è·å–å¾…åŠåˆ—è¡¨\nconst getTodoList = () => {\n  // æ¸…ç©º data.value\n  data.value.splice(0, data.value.length);\n  // å¤„ç†å½“å‰é¡µç \n  if (sessionStorage.getItem(\"currentIndex\")) {\n    pagination.current = sessionStorage.getItem(\"currentIndex\");\n  }\n  getTodoListApi(pagination.current, pagination.pageSize)\n    .then((res) => {\n      if (res.data.code === 200) {\n        // è®¾ç½®åˆ†é¡µæ€»æ•°\n        pagination.total = res.data.data.total;\n        notDone.value = res.data.data.total;\n\n        // æ¸…ç©º data.valueï¼Œé¿å…å¤šæ¬¡è¿½åŠ å¯¼è‡´é‡å¤æ•°æ®\n        data.value = [];\n\n        // ç­›é€‰æ•°æ®ï¼šä»…ä¿ç•™ operation ä¸º 0 çš„é¡¹\n        const filteredData = res.data.data.data.filter(\n          (item) => item.operation === 0\n        );\n\n        // æ˜ å°„æ•°æ®ï¼Œæ ¼å¼åŒ–å¹¶è¿½åŠ åˆ° data.value\n        data.value.push(\n          ...filteredData.map((item, index) => ({\n            key: item.id,\n            index: pagination.current * pagination.pageSize - pagination.pageSize + index + 1, \n            taskTag: item.type,\n            taskDetail: item.detail,\n            submitTime: item.presentDate,\n            operation: item.operation,\n            evaluatedName: item.evaluatedName,\n            department: item.department,\n          }))\n        );\n      } else {\n        // å¤„ç†éæˆåŠŸå“åº”\n        message.error(\"è·å–å¤±è´¥ï¼\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      // æ•è·å¹¶å¤„ç†è¯·æ±‚é”™è¯¯\n      message.error(\"è¯·æ±‚å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼\");\n    });\n};\n\n// è®¾ç½®ä¸‰ç§ä»»åŠ¡æ ‡ç­¾çš„é¢œè‰²\nconst getTagColor = (taskTag) => {\n  if (taskTag === \"æ·»åŠ è¯„ä¼°äººå®¡æ‰¹\") return \"cyan\";\n  if (taskTag === \"æ·»åŠ è¢«è¯„ä¼°äººå®¡æ‰¹\") return \"orange\";\n  if (taskTag === \"å‘¨è¾¹è¯„è®®\") return \"purple\";\n  return \"green\";\n};\n// è°ƒç”¨api-è¿›è¡Œå•æ¡ä»»åŠ¡çš„åŒæ„\nconst handleAgreeOne = (record) => {\n  // 1ã€è·å–ä¼ å…¥æ¥å£çš„ä»»åŠ¡id\n  // 2ã€è°ƒç”¨å•æ¡åŒæ„æ¥å£\n  message.success(\"åŒæ„æˆåŠŸï¼\");\n};\n// å¤„ç†ç¿»é¡µ\nconst handleTableChange = (e) => {\n  pagination.current = Number(e.current); //æ›´æ–°å½“å‰é¡µç \n  pagination.pageSize = e.pageSize; //æ›´æ–°æ¯é¡µæ˜¾ç¤ºæ¡ç›®æ•°\n  sessionStorage.setItem(\"currentIndex\", pagination.current);\n  getTodoList(); // é‡æ–°è·å–åˆ—è¡¨æ•°æ®\n};\nconst openRefuse = ref(false); //æ‹’ç»ç†ç”±è¾“å…¥æ¡†é»˜è®¤ä¸å±•ç¤º\nconst showModal = () => {\n  openRefuse.value = true;\n};\nconst handleEnterQues = (record) => {\n  // 1ã€è·å–recordä¸­çš„è¢«è¯„ä¼°äººä¿¡æ¯ï¼ˆå§“å+éƒ¨é—¨ï¼‰\n  const evaluatedName = record.evaluatedName;\n  const department = record.department;\n  const todoListId = record.key;\n  // 2ã€é€šè¿‡sessionä¼ é€’ä¿¡æ¯\n  sessionStorage.setItem(\"evaluatedName\", evaluatedName);\n  sessionStorage.setItem(\"department\", department);\n  sessionStorage.setItem(\"todoListId\", todoListId);\n  // 3ã€é¡µé¢è·³è½¬\n  if (localStorage.getItem(\"userRole\") === \"0\") {\n    router.push({\n      path: \"/quesnaireEdit\",\n    });\n  } else {\n    router.push({\n      path: \"/quesnaireEditAd\",\n    });\n  }\n};\nconst openDetail = ref(false); //æŸ¥çœ‹è¯¦æƒ…å¼¹çª—é»˜è®¤ä¸å±•ç¤º\nconst showDetail = () => {\n  openDetail.value = true;\n};\nconst openEvaluator = ref(false); //æ·»åŠ è¢«è¯„ä¼°äººå¼¹çª—é»˜è®¤ä¸å±•ç¤º\nconst showEvaluator = () => {\n  openEvaluator.value = true;\n};\nconst evaluator = ref([]);\nconst options = ref([]);\n// è·å–äººå‘˜åˆ—è¡¨\nconst getUserList = () => {\n  getUserListApi()\n    .then((res) => {\n      if (res.data.code === 200) {\n        options.value = [];\n        for (let i = 0; i <= res.data.data.length - 1; i++) {\n          options.value.push({\n            value:\n              res.data.data[i].name + \"(\" + res.data.data[i].department + \")\",\n            key: res.data.data[i].userId,\n          });\n        }\n      } else {\n        message.error(\"è·å–å¤±è´¥ï¼\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      message.error(\"è¯·æ±‚å¤±è´¥ï¼\"+ err);\n    });\n};\n// è°ƒç”¨api-å°†é€‰æ‹©çš„è¢«è¯„ä¼°äººkeyå€¼ä¼ ç»™åç«¯\nconst isSubmitting = ref(false);\nconst handleEvaluatorOk = () => {\n  if (isSubmitting.value) {\n        message.warning(\"æ­£åœ¨æäº¤ä¸­ï¼Œè¯·å‹¿é‡å¤æäº¤ï¼\");\n        return; // æ­£åœ¨æäº¤ä¸­ï¼Œç›´æ¥è¿”å›ï¼Œé¿å…é‡å¤æäº¤\n    }\n  isSubmitting.value = true;\n  // 1ã€è·å–è¢«è¯„ä¼°äººkeyå€¼\n  const selectedKeys = evaluator.value.map(\n    (item) => options.value.find((opt) => opt.value === item).key\n  );\n  if (selectedKeys.length === 0) {\n    message.warn(\"æ‚¨è¿˜æœªé€‰æ‹©è¢«è¯„ä¼°äººå“¦ğ–¦¹ğ–¦¹ .áŸ.áŸ \");\n    return;\n  }\n  if (selectedKeys.length > 3) {\n    message.warn(\"æœ€å¤šåªèƒ½é€‰æ‹©ä¸‰ä¸ªè¢«è¯„ä¼°äººå“¦ğ–¦¹ğ–¦¹ .áŸ.áŸ \");\n    return;\n  }\n  // 2ã€è°ƒç”¨æ·»åŠ è¢«è¯„ä¼°äººæ¥å£ï¼ˆè‹¥æ·»åŠ æˆåŠŸï¼Œæ¸…é™¤evaluatorå€¼ï¼‰\n  getEvaluatedListApi(selectedKeys)\n    .then((res) => {\n      if (res.data.code === 200) {\n        message.success(\"æ·»åŠ æˆåŠŸï¼\");\n        evaluator.value = [];\n        getAssessor(); // åˆ·æ–°è¢«è¯„ä¼°äººè¡¨æ ¼\n        getTodoList(); // åˆ·æ–°å¾…åŠè¡¨æ ¼\n        openEvaluator.value = false; // 3ã€å…³é—­å¼¹çª—\n      } else {\n        message.error(\"æ·»åŠ å¤±è´¥ï¼\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      message.error(\"è¯·æ±‚å¤±è´¥ï¼\"+ err);\n    })\n    .finally(() => {\n      isSubmitting.value = false; // æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½å°†æäº¤çŠ¶æ€ç½®ä¸º false\n    });\n};\n\n// æ·»åŠ è‡ªä¸»è¯„ä¼°äººç›¸å…³é…ç½®\nconst columnsDetail = ref([\n  {\n    title: \"åºå·\",\n    dataIndex: \"index\",\n    key: \"index\",\n    align: \"center\",\n  },\n  {\n    title: \"å§“å\",\n    dataIndex: \"username\",\n    key: \"username\",\n    align: \"center\",\n  },\n  {\n    title: \"éƒ¨é—¨\",\n    dataIndex: \"department\",\n    key: \"department\",\n    align: \"center\",\n  },\n]);\nconst dataDetail = ref([]);\nconst getAssessor = () => {\n  getAssessorApi()\n    .then((res) => {\n      if (res.data.code === 200) {\n        dataDetail.value = [];\n        for (let i = 0; i <= res.data.data.length - 1; i++) {\n          dataDetail.value.push({\n            index: i + 1,\n            username: res.data.data[i].username,\n            department: res.data.data[i].department,\n          });\n        }\n      } else {\n        message.error(\"è·å–å¤±è´¥ï¼\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      message.error(\"è¯·æ±‚å¤±è´¥ï¼\"+ err);\n    });\n};\n\n// è·å–å½“å‰æ—¶é—´å¹¶æ ¼å¼åŒ–\nconst getCurrentDateTime = () => {\n  const now = new Date();\n  const year = now.getFullYear();\n  const month = (now.getMonth() + 1).toString().padStart(2, \"0\"); // æœˆä»½æ˜¯ä»0å¼€å§‹çš„\n  const day = now.getDate().toString().padStart(2, \"0\");\n  return `${year}-${month}-${day}`;\n};\n\n// å¯¼å‡ºæ‰“åˆ†æƒ…å†µ\nconst exportData = () => {\n  getExportSelfDataApi()\n    .then((res) => {\n      // åˆ¤æ–­å“åº”æ˜¯å¦ä¸ºæ–‡ä»¶æµ\n      if (res && res.data) {\n        const blob = new Blob([res.data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n        const link = document.createElement('a');\n        const url = URL.createObjectURL(blob);\n\n        // ä½¿ç”¨å½“å‰æ—¥æœŸæ¥åŠ¨æ€ç”Ÿæˆæ–‡ä»¶å\n        const fileName = `æœ¬è½®å…¨éƒ¨æ‰“åˆ†æƒ…å†µ${getCurrentDateTime()}.xlsx`;\n\n        link.href = url;\n        link.download = fileName;  // è®¾ç½®æ–‡ä»¶å\n        link.click();  // è§¦å‘ä¸‹è½½\n        message.success(\"æœ¬è½®å…¨éƒ¨æ‰“åˆ†æƒ…å†µå¯¼å‡ºæˆåŠŸï¼\");\n      } else {\n        message.error(\"å¯¼å‡ºå¤±è´¥ï¼æœªçŸ¥é”™è¯¯\");\n      }\n    })\n    .catch((err) => {\n      console.error('è¯·æ±‚å¤±è´¥ï¼š', err);\n      message.error(\"è¯·æ±‚å¤±è´¥ï¼\");\n    });\n}\n\n// å¯¼å‡ºå¾…è¯„åˆ†åˆ—è¡¨\nconst exportEvaluatedInfo = () => {\n  getExportEvaluatedInfoApi()\n    .then((res) => {\n      // åˆ¤æ–­å“åº”æ˜¯å¦ä¸ºæ–‡ä»¶æµ\n      if (res && res.data) {\n        const blob = new Blob([res.data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });\n        const link = document.createElement('a');\n        const url = URL.createObjectURL(blob);\n\n        // ä½¿ç”¨å½“å‰æ—¥æœŸæ¥åŠ¨æ€ç”Ÿæˆæ–‡ä»¶å\n        const fileName = `å¾…è¯„åˆ†åˆ—è¡¨${getCurrentDateTime()}.xlsx`;\n\n        link.href = url;\n        link.download = fileName;  // è®¾ç½®æ–‡ä»¶å\n        link.click();  // è§¦å‘ä¸‹è½½\n        message.success(\"å¾…è¯„åˆ†åˆ—è¡¨å¯¼å‡ºæˆåŠŸï¼\");\n      } else {\n        message.error(\"å¯¼å‡ºå¤±è´¥ï¼æœªçŸ¥é”™è¯¯\");\n      }\n    })\n    .catch((err) => {\n      console.error('è¯·æ±‚å¤±è´¥ï¼š', err);\n      message.error(\"è¯·æ±‚å¤±è´¥ï¼\");\n    });\n}\n</script>\n\n<template>\n  <div class=\"todoList-container\">\n    <div class=\"left\">\n      <!-- æ ‡é¢˜åŒºåŸŸ -->\n      <div class=\"title\">\n        <span v-if=\"notDone!==0\">æˆ‘çš„å¾…åŠ&ensp;<span class=\"not-done\">æœªå®Œæˆï¼š{{ notDone }}</span></span>\n        <span v-else>æˆ‘çš„å¾…åŠ&ensp;<span class=\"all-done\">å·²ç»å®Œæˆæ‰“åˆ†ä»»åŠ¡</span></span>\n        <span>\n          <a-button type=\"primary\" style=\"margin-right:10px;\" @click=\"exportEvaluatedInfo\" :disabled=\"isVisible\">\n            å¯¼å‡ºå¾…è¯„åˆ†åˆ—è¡¨\n          </a-button>\n          <a-button type=\"primary\" style=\"background-color: #39ba06;\" @click=\"exportData\">\n            å¯¼å‡ºæ‰“åˆ†æƒ…å†µ\n          </a-button>\n        </span>\n      </div>\n      <!-- å†…å®¹åŒºåŸŸ -->\n      <div class=\"todoTable\">\n        <!-- å¾…åŠè¡¨æ ¼ -->\n        <a-table\n          :columns=\"columns\"\n          :data-source=\"data\"\n          :rowKey=\"(record) => record.key\"\n          :scroll=\"{ y: scrollHeight }\"\n          :pagination=\"pagination\"\n          :bordered=\"true\"\n          @change=\"handleTableChange\"\n        >\n          <template #bodyCell=\"{ column, record }\">\n            <!-- è®¾ç½®ä¸‰ç§ä»»åŠ¡æ ‡ç­¾çš„é¢œè‰² -->\n            <template v-if=\"column.key === 'taskTag'\">\n              <span>\n                <a-tag\n                  :key=\"record.taskTag\"\n                  :color=\"getTagColor(record.taskTag)\"\n                >\n                  {{ record.taskTag }}\n                </a-tag>\n              </span>\n            </template>\n            <!-- è®¾ç½®æ“ä½œæ  -->\n            <template v-if=\"column.key === 'action'\">\n              <span v-if=\"record.taskTag === 'æ·»åŠ è¯„ä¼°äººå®¡æ‰¹'\">\n                <a\n                  style=\"color: #0014b7; text-decoration: underline\"\n                  @click=\"showDetail\"\n                  >æŸ¥çœ‹è¯¦æƒ…</a\n                >\n                <a-divider type=\"vertical\" />\n                <a style=\"color: #bd3124; font-weight: bold\" @click=\"showModal\"\n                  >æ‹’ç»</a\n                >\n              </span>\n              <span v-else-if=\"record.taskTag === 'æ·»åŠ è¢«è¯„ä¼°äººå®¡æ‰¹'\">\n                <a\n                  style=\"color: #3f9373; font-weight: bold\"\n                  @click=\"handleAgreeOne(record)\"\n                  >åŒæ„</a\n                >\n                <a-divider type=\"vertical\" />\n                <a style=\"color: #bd3124; font-weight: bold\" @click=\"showModal\"\n                  >æ‹’ç»</a\n                >\n              </span>\n              <span v-else-if=\"record.taskTag === 'å‘¨è¾¹è¯„è®®'\">\n                <a\n                  style=\"color: #3f9373; font-weight: bold\"\n                  @click=\"handleEnterQues(record)\"\n                  >è¿›å…¥è¯„è®®</a\n                >\n              </span>\n            </template>\n          </template>\n        </a-table>\n      </div>\n    </div>\n    <div class=\"right\">\n      <a-button type=\"primary\" @click=\"showEvaluator\"> æˆ‘è¦è¯„ä¼° </a-button>\n      <!-- æˆ‘è¦è¯„ä¼°è¡¨æ ¼ -->\n      <div style=\"margin-top: 10px\">\n        <a-table\n          :columns=\"columnsDetail\"\n          :data-source=\"dataDetail\"\n          :bordered=\"false\"\n          :pagination=\"false\"\n          :scroll=\"{ y: '60vh' }\"\n        >\n        </a-table>\n      </div>\n\n      <!-- æ·»åŠ è¢«è¯„ä¼°äººå¼¹çª— -->\n      <a-modal\n        v-model:open=\"openEvaluator\"\n        title=\"æ·»åŠ è¢«è¯„ä¼°äºº\"\n        @ok=\"handleEvaluatorOk\"\n      >\n        <span style=\"color: #bd3124\">æ³¨ï¼šæ‚¨å¯ä»¥è‡ªä¸»é€‰æ‹©1-3ä¸ªè¦è¯„ä¼°çš„äºº</span>\n        <a-select\n          v-model:value=\"evaluator\"\n          :options=\"options\"\n          mode=\"multiple\"\n          placeholder=\"è¯·é€‰æ‹©\"\n          style=\"width: 100%\"\n        >\n        </a-select>\n      </a-modal>\n    </div>\n  </div>\n</template>\n\n<style lang=\"less\" scoped>\n.todoList-container {\n  // border: 1px solid red;\n  display: flex;\n  width: 100%;\n  height: 100%;\n  gap: 10px;\n}\n\n.left {\n  border: 1.5px dashed rgba(128, 191, 255, 0.7);\n  width: 70%;\n  padding: 10px 10px 0px 10px;\n  /* ç»™å·¦ä¾§åŒºåŸŸåŠ ç‚¹å†…è¾¹è· */\n\n  .title {\n    // border: 1px solid blue;\n    height: 35px;\n    display: flex;\n    justify-content: space-between;\n    margin: 0px 10px 10px 10px;\n\n    .not-done {\n        font-weight: bold;\n        color: #dc3545; // key éƒ¨åˆ†æ”¹ä¸ºè“è‰²\n        background-color: #f8d7da; // ç»™keyéƒ¨åˆ†åŠ èƒŒæ™¯è‰²ï¼Œæ”¹ä¸ºæ·¡è“è‰²\n        padding: 5px 8px;\n        border-radius: 4px;\n      }\n    \n    .all-done {\n      font-weight: bold;\n      color: #28a745; // key éƒ¨åˆ†æ”¹ä¸ºè“è‰²\n      background-color: #d4edda; // ç»™keyéƒ¨åˆ†åŠ èƒŒæ™¯è‰²ï¼Œæ”¹ä¸ºæ·¡è“è‰²\n      padding: 5px 8px;\n      border-radius: 4px;\n    }\n\n    span {\n      font-size: 16px;\n      font-weight: bold;\n      display: flex;\n      align-items: center;\n    }\n  }\n\n  .todoTable {\n    height: calc(100% - 35px - 10px);\n    max-height: calc(100% - 35px - 10px);\n    // border: 1px solid red;\n    margin: 0 10px 0 10px;\n    overflow: hidden;\n    /* é˜²æ­¢æ»šåŠ¨æ¡æº¢å‡º */\n  }\n\n  ::v-deep .ant-table-tbody>tr>td {\n    padding: 13px 5px;\n  }\n\n  ::v-deep .ant-table-thead>tr>th {\n    padding: 13px 5px;\n  }\n}\n\n.right {\n  // border: 1px solid orange;\n  width: 30%;\n  padding: 15px;\n  background-color: rgba(179, 217, 255, 0.3);\n  box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: flex-start;\n\n  ::v-deep .ant-table-thead>tr>th {\n    padding: 13px 5px;\n  }\n}\n</style>","import script from \"./TodoList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TodoList.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TodoList.vue?vue&type=style&index=0&id=e7093a44&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_webpack@5.95.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e7093a44\"]])\n\nexport default __exports__"],"names":["getTodoListApi","pageNum","pageSize","Promise","resolve","reject","axios","method","url","headers","params","then","response","catch","error","getUserListApi","getEvaluatedListApi","userIds","data","JSON","stringify","getAssessorApi","getExportSelfDataApi","responseType","getExportEvaluatedInfoApi","onMounted","getTodoList","getUserList","updateScrollHeight","getStepTime","window","addEventListener","getAssessor","isVisible","ref","currentSession","getStepTimeApi","res","code","i","evaluateStep","length","enable","value","message","msg","err","console","log","onUnmounted","removeEventListener","scrollHeight","router","useRouter","pagination","reactive","current","showSizeChanger","total","showTotal","range","columns","title","dataIndex","key","width","align","screenHeight","innerHeight","containerHeight","notDone","splice","sessionStorage","getItem","filteredData","filter","item","operation","push","map","index","id","taskTag","type","taskDetail","detail","submitTime","presentDate","evaluatedName","department","getTagColor","handleAgreeOne","record","success","handleTableChange","e","Number","setItem","openRefuse","showModal","handleEnterQues","todoListId","localStorage","path","openDetail","showDetail","openEvaluator","showEvaluator","evaluator","options","name","userId","isSubmitting","handleEvaluatorOk","warning","selectedKeys","find","opt","warn","finally","columnsDetail","dataDetail","username","getCurrentDateTime","now","Date","year","getFullYear","month","getMonth","toString","padStart","day","getDate","exportData","blob","Blob","link","document","createElement","URL","createObjectURL","fileName","href","download","click","exportEvaluatedInfo","__exports__"],"sourceRoot":""}