{"version":3,"file":"js/528.c6b56c78.js","mappings":"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","sources":["webpack://scoring_system_front/./src/components/TimeLine.vue","webpack://scoring_system_front/./src/components/TimeLine.vue?14fd","webpack://scoring_system_front/./src/components/TimeSet.vue","webpack://scoring_system_front/./src/components/TimeSet.vue?61e0","webpack://scoring_system_front/./src/page/admin/ScoringTimeSet.vue"],"sourcesContent":["<!-- 评估时间轴展示 -->\n<template>\n    <div class=\"timeline-container\">\n        <span class=\"timeline-title\">本轮评估流程时间节点</span>\n        <div class=\"timeline-content\">\n            <a-steps v-model:current=\"current\" :items=\"items\" :disabled=\"true\">\n                <template #progressDot=\"{ index, status, prefixCls }\">\n                    <a-popover>\n                        <span :class=\"`${prefixCls}-icon-dot`\"></span>\n                    </a-popover>\n                </template>\n            </a-steps>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { onMounted, ref } from \"vue\"\nimport { getStepTimeApi } from \"@/api/scoreTimeSet\"\n\nconst current = ref(2);\nconst items = ref([\n    {\n        title: '建立评估矩阵关系',\n        description: '07.01-07.05',\n    }\n])\n\n// 获取评估节点\nconst getStepTime = () => {\n    getStepTimeApi()\n        .then(res => {\n            if (res.data.code === 200) {\n                items.value = [];\n                for (let i = 0; i <= res.data.data.evaluateStep.length - 1; i++) {\n                    const startDate = res.data.data.evaluateStep[i].startDate.replace(/-/g, '.'); // 替换开始时间的格式\n                    const endDate = res.data.data.evaluateStep[i].endDate.replace(/-/g, '.'); // 替换结束时间的格式\n\n                    items.value.push({\n                        title: res.data.data.evaluateStep[i].description,\n                        description: `${startDate}-${endDate}` // 拼接新的描述字段\n                    });\n\n                    if(res.data.data.evaluateStep[i].enable === 1){\n                        current.value = i;\n                    }\n                }\n            } else {\n                console.log('获取失败！', res.data.msg);\n            }\n        })\n        .catch(err => {\n            console.log('获取失败！', err);\n        });\n};\n\nonMounted(() => {\n    getStepTime()\n})\n</script>\n\n<style lang=\"less\" scoped>\n.timeline-container {\n    width: 100%;\n    height: 100%;\n    padding: 10px;\n\n    .timeline-title {\n        display: block;\n        font-size: 16px;\n        font-weight: bold;\n        margin-bottom: 15px;\n    }\n\n    .timeline-content {\n        border: 1px dashed #3a8ee6; // 边框为蓝色虚线\n        background-color: #e6f7ff; // 浅蓝色背景\n        padding: 10px;\n\n        .a-steps {\n            width: 100%;\n        }\n\n        .a-steps-item-title {\n            font-size: 16px;\n            font-weight: bold;\n        }\n\n        .a-steps-item-description {\n            font-size: 14px;\n        }\n\n        ::v-deep .ant-steps-item-title {\n            font-size: 14px;\n            /* 调整这里的字体大小 */\n            font-weight: bold;\n        }\n\n        ::v-deep .ant-steps-item-description {\n            font-size: 12px;\n            /* 如果需要调整描述的字体大小，也可以在这里修改 */\n        }\n    }\n}\n</style>","import script from \"./TimeLine.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TimeLine.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TimeLine.vue?vue&type=style&index=0&id=286cdc00&lang=less&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.10_webpack@5.95.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-286cdc00\"]])\n\nexport default __exports__","<!-- 时间节点设置 -->\n<template>\n    <div class=\"timeset-container\">\n        <div class=\"timeset-header\">\n            <span class=\"timeset-title\">设置评估流程时间节点</span>\n            <div class=\"btn-area\">\n                <a-button type=\"primary\" @click=\"publishNewRound\"\n                    style=\"background-color: #68BBC4;\">发布新一轮评估时间</a-button>\n                <a-button type=\"primary\" @click=\"editTime\" ghost>修改当前时间节点</a-button>\n            </div>\n        </div>\n\n        <div class=\"timeset-content\">\n            <!-- 时间设置区域 -->\n            <div class=\"timeset-area\">\n                <a-form>\n                    <a-row :gutter=\"20\">\n                        <a-col :span=\"10\">\n                            <a-form-item label=\"建立评估矩阵关系\" :rules=\"[{ required: true, message: '请填写！' }]\">\n                                <a-range-picker v-model:value=\"formTime.relBuildingTime\" :disabled=\"!isEdit\"\n                                    style=\"width: 250px;\" />\n                            </a-form-item>\n                        </a-col>\n                        <a-col :span=\"10\">\n                            <a-form-item label=\"上级评估/周边评估\" :rules=\"[{ required: true, message: '请填写！' }]\">\n                                <a-range-picker v-model:value=\"formTime.evaluationTime\" :disabled=\"!isEdit\"\n                                    style=\"width: 250px;\" />\n                            </a-form-item>\n                        </a-col>\n                    </a-row>\n\n                    <a-row :gutter=\"20\">\n                        <a-col :span=\"10\">\n                            <a-form-item label=\"结果沟通\" :rules=\"[{ required: true, message: '请填写！' }]\">\n                                <a-range-picker v-model:value=\"formTime.resCommunicaTime\" :disabled=\"!isEdit\"\n                                    style=\"width: 250px;\" />\n                            </a-form-item>\n                        </a-col>\n                        <a-col :span=\"10\">\n                            <a-form-item label=\"结果发布\" :rules=\"[{ required: true, message: '请填写！' }]\">\n                                <a-range-picker v-model:value=\"formTime.resultReleaseTime\" :disabled=\"!isEdit\"\n                                    style=\"width: 250px;\" />\n                            </a-form-item>\n                        </a-col>\n                    </a-row>\n                </a-form>\n                <div class=\"save-btn\">\n                    <a-button type=\"primary\" html-type=\"submit\" v-if=\"isEdit\" @click=\"handleSubmit\">发布 / 修改</a-button>\n                </div>\n            </div>\n\n        </div>\n    </div>\n</template>\n\n\n<script setup>\nimport { ref, createVNode, reactive, onMounted } from \"vue\"\nimport { Modal } from 'ant-design-vue'\nimport { ExclamationCircleOutlined } from '@ant-design/icons-vue'\nimport dayjs from \"dayjs\";\nimport { message } from 'ant-design-vue'\nimport { getStepTimeApi, getEditTimeApi } from \"@/api/scoreTimeSet\"\n\nconst formTime = reactive({\n    relBuildingTime: [dayjs('2024-01-01'), dayjs('2024-01-02')],\n    evaluationTime: [dayjs('2024-01-05'), dayjs('2024-01-10')],\n    resCommunicaTime: [dayjs('2024-02-01'), dayjs('2024-02-05')],\n    resultReleaseTime: [dayjs('2024-03-01'), dayjs('2024-03-05')]\n})\n\nconst btnType = ref('0')\n\nconst isEdit = ref(false)\nconst publishNewRound = () => {\n    isEdit.value = !isEdit.value\n    btnType.value = '1'\n}\n\nconst editTime = () => {\n    isEdit.value = !isEdit.value\n    btnType.value = '2'\n}\n\n// 获取当前时间节点\nconst getStepTime = () => {\n    getStepTimeApi()\n        .then(res => {\n            if (res.data.code === 200) {\n                formTime.relBuildingTime = [\n                    dayjs(res.data.data.evaluateStep[0].startDate),\n                    dayjs(res.data.data.evaluateStep[0].endDate)\n                ]\n                formTime.evaluationTime = [\n                    dayjs(res.data.data.evaluateStep[1].startDate),\n                    dayjs(res.data.data.evaluateStep[1].endDate)\n                ]\n                formTime.resCommunicaTime = [\n                    dayjs(res.data.data.evaluateStep[2].startDate),\n                    dayjs(res.data.data.evaluateStep[2].endDate)\n                ]\n                formTime.resultReleaseTime = [\n                    dayjs(res.data.data.evaluateStep[3].startDate),\n                    dayjs(res.data.data.evaluateStep[3].endDate)\n                ]\n            } else {\n                console.log('获取失败！', res.data.msg);\n            }\n        })\n        .catch(err => {\n            console.log('获取失败！', err);\n        });\n};\n\n// 调用api-提交新时间\nconst handleSubmit = () => {\n    const title = ref('')\n    if (btnType.value === '1') {\n        title.value = '确定要发布新一轮评估吗？'\n    } else if (btnType.value === '2') {\n        title.value = '确定要修改评估时间吗？'\n    } else {\n        title.value = 'undefined'\n    }\n    // 检查四项时间是否都填写完整\n    const isFormComplete = formTime.relBuildingTime && formTime.evaluationTime &&\n        formTime.resCommunicaTime && formTime.resultReleaseTime\n    if (!isFormComplete) {\n        // 提示用户填写完整\n        message.warning('请将所有时间填写完整哦~');\n        return\n    }\n    // 确认弹窗\n    Modal.confirm({\n        title: title.value,\n        icon: createVNode(ExclamationCircleOutlined),\n        onOk() {\n            // 预处理8个时间字段\n            const newtime = [\n                ...formTime.relBuildingTime.map(date => date.format('YYYY-MM-DD')),\n                ...formTime.evaluationTime.map(date => date.format('YYYY-MM-DD')),\n                ...formTime.resCommunicaTime.map(date => date.format('YYYY-MM-DD')),\n                ...formTime.resultReleaseTime.map(date => date.format('YYYY-MM-DD')),\n            ];\n            if (btnType.value === '1') {\n                // 调用api-发布新一轮评估时间\n                getEditTimeApi(true, newtime).then(res => {\n                    if (res.data.code === 200) {\n                        message.success('发布成功！')\n                        // 刷新页面\n                        setTimeout(() => {\n                            location.reload();\n                        }, 500); // 延迟0.5秒刷新页面\n                    } else {\n                        message.error('发布失败！' + res.data.msg);\n                        // 刷新页面\n                        setTimeout(() => {\n                            location.reload();\n                        }, 500); // 延迟0.5秒刷新页面\n                    }\n                }).catch(err => {\n                    console.log(err)\n                })\n            } else {\n                getEditTimeApi(false, newtime).then(res => {\n                    if (res.data.code === 200) {\n                        message.success('修改成功！')\n                        // 刷新页面\n                        setTimeout(() => {\n                            location.reload();\n                        }, 500); // 延迟0.5秒刷新页面\n                    } else {\n                        message.error('修改失败！' + res.data.msg);\n                        // 刷新页面\n                        setTimeout(() => {\n                            location.reload();\n                        }, 500); // 延迟0.5秒刷新页面\n                    }\n                }).catch(err => {\n                    console.log(err)\n                })\n            }\n            isEdit.value = false\n        },\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\n        onCancel() { },\n    });\n}\n\nonMounted(() => {\n    getStepTime()\n})\n</script>\n\n<style lang=\"less\" scoped>\n.timeset-container {\n    margin: 30px 10px 10px 10px;\n\n    .timeset-header {\n        display: flex;\n        justify-content: space-between;\n\n        .timeset-title {\n            display: block;\n            font-size: 16px;\n            font-weight: bold;\n            margin-bottom: 15px;\n        }\n\n        .btn-area {\n            margin-bottom: 10px;\n\n            &> :nth-child(1) {\n                margin-right: 10px;\n            }\n        }\n    }\n\n    .timeset-content {\n        border-top: 1px dashed #3a8ee6; // 边框为蓝色虚线\n        background-color: #e6f7ff; // 浅蓝色背景\n        padding: 10px;\n\n        .timeset-area {\n            margin: 5vh;\n            border: 1px solid #d9d9d9;\n            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n            border-radius: 5px;\n            padding: 7vh;\n\n            .save-btn {\n                display: flex;\n                justify-content: center;\n                align-content: center;\n                margin-top: 20px;\n            }\n        }\n    }\n}\n</style>","import script from \"./TimeSet.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TimeSet.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TimeSet.vue?vue&type=style&index=0&id=2c263ec8&lang=less&scoped=true\"\n\nimport exportComponent from \"../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.10_webpack@5.95.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2c263ec8\"]])\n\nexport default __exports__","import script from \"./ScoringTimeSet.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ScoringTimeSet.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["current","ref","items","title","description","getStepTime","getStepTimeApi","then","res","data","code","value","i","evaluateStep","length","startDate","replace","endDate","push","enable","console","log","msg","catch","err","onMounted","__exports__","formTime","reactive","relBuildingTime","dayjs","evaluationTime","resCommunicaTime","resultReleaseTime","btnType","isEdit","publishNewRound","editTime","handleSubmit","isFormComplete","Modal","confirm","icon","createVNode","ExclamationCircleOutlined","onOk","newtime","map","date","format","getEditTimeApi","message","success","setTimeout","location","reload","error","onCancel","warning"],"sourceRoot":""}