"use strict";(self["webpackChunkscoring_system_front"]=self["webpackChunkscoring_system_front"]||[]).push([[375],{615:function(e,a,t){t.d(a,{W:function(){return s},r:function(){return n}});var l=t(5857);const n=()=>new Promise(((e,a)=>{(0,l.A)({method:"get",url:"/api/evaluate/table",headers:{"Content-Type":"application/json"}}).then((a=>{e(a)})).catch((e=>{a(e.response)}))})),s=(e,a,t,n)=>new Promise(((s,u)=>{let i={meanings:e,principles:a,openingRemarks:t,title:n};(0,l.A)({method:"post",url:"/api/evaluate/table/update",headers:{"Content-Type":"application/json"},data:JSON.stringify(i)}).then((e=>{s(e)})).catch((e=>{u(e.response)}))}))},8717:function(e,a,t){t.d(a,{A:function(){return p}});t(9138);var l=t(7616),n=t(5929),s=t(3e3),u=t(543),i=t(615);const o={class:"timeline-container"},d={class:"timeline-title"},r={class:"timeline-content"};var c={__name:"TimeLine",setup(e){const a=(0,s.KR)(2),t=(0,s.KR)([{title:"建立评估矩阵关系",description:"07.01-07.05"}]),c=()=>{(0,u.Q)().then((e=>{if(200===e.data.code){t.value=[];for(let l=0;l<=e.data.data.evaluateStep.length-1;l++){const n=e.data.data.evaluateStep[l].startDate.replace(/-/g,"."),s=e.data.data.evaluateStep[l].endDate.replace(/-/g,".");t.value.push({title:e.data.data.evaluateStep[l].description,description:`${n}-${s}`}),1===e.data.data.evaluateStep[l].enable&&(a.value=l)}}else console.log("获取失败！",e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))},v=(0,s.KR)(""),m=()=>{(0,i.r)().then((e=>{200===e.data.code?v.value=e.data.data.title:message.error("获取失败！"+e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))};return(0,l.sV)((()=>{c(),m()})),(e,s)=>{const u=(0,l.g2)("a-popover"),i=(0,l.g2)("a-steps");return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("span",d,(0,n.v_)(v.value)+"-评估流程时间节点",1),(0,l.Lk)("div",r,[(0,l.bF)(i,{current:a.value,"onUpdate:current":s[0]||(s[0]=e=>a.value=e),items:t.value,disabled:!0},{progressDot:(0,l.k6)((({index:e,status:a,prefixCls:t})=>[(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.Lk)("span",{class:(0,n.C4)(`${t}-icon-dot`)},null,2)])),_:2},1024)])),_:1},8,["current","items"])])])}}},v=t(3578);const m=(0,v.A)(c,[["__scopeId","data-v-566b31ef"]]);var p=m},375:function(e,a,t){t.r(a),t.d(a,{default:function(){return R}});var l=t(7616),n=t(8717),s=t(3e3),u=t(4490),i=t(6565),o=t(3369),d=t.n(o),r=t(1516),c=t(543);const v={class:"timeset-container"},m={class:"timeset-header"},p={class:"btn-area"},g={key:0,style:{color:"red","margin-bottom":"5px"}},b={class:"timeset-content"},f={class:"timeset-area"},k={class:"save-btn"};var h={__name:"TimeSet",setup(e){const a=(0,s.KR)(localStorage.getItem("userRole")),t=(0,s.KR)(!1);"3"===a.value&&(t.value=!0);const n=(0,s.KR)(!1),o=(0,s.KR)(""),h=()=>{""!==o.value?(n.value=!1,r.Ay.success("名称设置成功，请继续设置时间节点！"),!0===_.value||(_.value=!_.value),y.value="1"):r.Ay.warning("请输入评估周期名称！")},T=(0,s.Kh)({relBuildingTime:[d()("2024-01-01"),d()("2024-01-02")],evaluationTime:[d()("2024-01-05"),d()("2024-01-10")],resCommunicaTime:[d()("2024-02-01"),d()("2024-02-05")],resultReleaseTime:[d()("2024-03-01"),d()("2024-03-05")]}),y=(0,s.KR)("0"),_=(0,s.KR)(!1),C=()=>{n.value=!0},F=()=>{_.value=!_.value,y.value="2"},R=(0,s.KR)(),S=(0,s.KR)(!1),D=()=>{(0,c.Q)().then((e=>{if(200===e.data.code){T.relBuildingTime=[d()(e.data.data.evaluateStep[0].startDate),d()(e.data.data.evaluateStep[0].endDate)],T.evaluationTime=[d()(e.data.data.evaluateStep[1].startDate),d()(e.data.data.evaluateStep[1].endDate)],T.resCommunicaTime=[d()(e.data.data.evaluateStep[2].startDate),d()(e.data.data.evaluateStep[2].endDate)],T.resultReleaseTime=[d()(e.data.data.evaluateStep[3].startDate),d()(e.data.data.evaluateStep[3].endDate)];for(let a=0;a<=e.data.data.evaluateStep.length-1;a++)1===e.data.data.evaluateStep[a].enable&&(R.value=a+1+"","4"===R.value&&(S.value=!0))}else console.log("获取失败！",e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))},Y=()=>{const e=(0,s.KR)("");"1"===y.value?e.value="确定要发布新一轮评估吗？":"2"===y.value?e.value="确定要修改评估时间吗？":e.value="undefined";const a=T.relBuildingTime&&T.evaluationTime&&T.resCommunicaTime&&T.resultReleaseTime;a?u.A.confirm({title:e.value,icon:(0,l.bF)(i.A),onOk(){const e=[...T.relBuildingTime.map((e=>e.format("YYYY-MM-DD"))),...T.evaluationTime.map((e=>e.format("YYYY-MM-DD"))),...T.resCommunicaTime.map((e=>e.format("YYYY-MM-DD"))),...T.resultReleaseTime.map((e=>e.format("YYYY-MM-DD")))];"1"===y.value?(0,c.a)(!0,e,o.value).then((e=>{200===e.data.code?(r.Ay.success("发布成功！"),setTimeout((()=>{location.reload()}),500)):(r.Ay.error("发布失败！"+e.data.msg),setTimeout((()=>{location.reload()}),1e3))})).catch((e=>{console.log(e)})):(0,c.a)(!1,e).then((e=>{200===e.data.code?(r.Ay.success("修改成功！"),setTimeout((()=>{location.reload()}),500)):(r.Ay.error("修改失败！"+e.data.msg),setTimeout((()=>{location.reload()}),500))})).catch((e=>{console.log(e)})),_.value=!1},onCancel(){}}):r.Ay.warning("请将所有时间填写完整哦~")};return(0,l.sV)((()=>{D()})),(e,a)=>{const s=(0,l.g2)("a-button"),u=(0,l.g2)("a-input"),i=(0,l.g2)("a-modal"),d=(0,l.g2)("a-range-picker"),r=(0,l.g2)("a-form-item"),c=(0,l.g2)("a-row"),y=(0,l.g2)("a-form");return(0,l.uX)(),(0,l.CE)("div",v,[(0,l.Lk)("div",m,[a[8]||(a[8]=(0,l.Lk)("span",{class:"timeset-title"},"设置评估流程时间节点",-1)),(0,l.Lk)("div",p,[(0,l.bF)(s,{type:"primary",onClick:C,style:{"background-color":"#68BBC4"},disabled:!t.value},{default:(0,l.k6)((()=>a[6]||(a[6]=[(0,l.eW)("发布新一轮评估时间")]))),_:1},8,["disabled"]),(0,l.bF)(i,{open:n.value,"onUpdate:open":a[1]||(a[1]=e=>n.value=e),title:"定义新一轮评估名称",okText:"开始设置评估时间",onOk:h},{default:(0,l.k6)((()=>[S.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",g,"注意：当前评估还未完成！若仍要发起新一轮评估请继续操作即可~")),(0,l.bF)(u,{value:o.value,"onUpdate:value":a[0]||(a[0]=e=>o.value=e),placeholder:"例如：2023-2024年第一期评估"},null,8,["value"])])),_:1},8,["open"]),(0,l.bF)(s,{type:"primary",onClick:F,ghost:"",disabled:!t.value},{default:(0,l.k6)((()=>a[7]||(a[7]=[(0,l.eW)("修改当前时间节点")]))),_:1},8,["disabled"])])]),(0,l.Lk)("div",b,[(0,l.Lk)("div",f,[(0,l.bF)(y,null,{default:(0,l.k6)((()=>[(0,l.bF)(c,{gutter:16,style:{"margin-bottom":"20px"}},{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:"建立评估矩阵关系","label-col":{span:8},rules:[{required:!0,message:"请填写！"}],style:{"margin-right":"30px"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:T.relBuildingTime,"onUpdate:value":a[2]||(a[2]=e=>T.relBuildingTime=e),disabled:!_.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1}),(0,l.bF)(r,{label:"上级评估/周边评估","label-col":{span:8},rules:[{required:!0,message:"请填写！"}]},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:T.evaluationTime,"onUpdate:value":a[3]||(a[3]=e=>T.evaluationTime=e),disabled:!_.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1})])),_:1}),(0,l.bF)(c,{gutter:16},{default:(0,l.k6)((()=>[(0,l.bF)(r,{label:"结果沟通",rules:[{required:!0,message:"请填写！"}],style:{"margin-right":"30px"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:T.resCommunicaTime,"onUpdate:value":a[4]||(a[4]=e=>T.resCommunicaTime=e),disabled:!_.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1}),(0,l.bF)(r,{label:"结果发布",rules:[{required:!0,message:"请填写！"}]},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:T.resultReleaseTime,"onUpdate:value":a[5]||(a[5]=e=>T.resultReleaseTime=e),disabled:!_.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1})])),_:1})])),_:1}),(0,l.Lk)("div",k,[_.value?((0,l.uX)(),(0,l.Wv)(s,{key:0,type:"primary","html-type":"submit",onClick:Y},{default:(0,l.k6)((()=>a[9]||(a[9]=[(0,l.eW)("发布 / 修改")]))),_:1})):(0,l.Q3)("",!0)])])])])}}},T=t(3578);const y=(0,T.A)(h,[["__scopeId","data-v-798e6f82"]]);var _=y,C={__name:"ScoringTimeSet",setup(e){return(e,a)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",null,[(0,l.bF)(n.A)]),(0,l.Lk)("div",null,[(0,l.bF)(_)])],64))}};const F=C;var R=F}}]);
//# sourceMappingURL=375.3cfb37b1.js.map