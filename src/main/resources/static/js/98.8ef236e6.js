"use strict";(self["webpackChunkscoring_system_front"]=self["webpackChunkscoring_system_front"]||[]).push([[98],{615:function(e,a,t){t.d(a,{W:function(){return u},r:function(){return n}});var l=t(5857);const n=()=>new Promise(((e,a)=>{(0,l.A)({method:"get",url:"/api/evaluate/table",headers:{"Content-Type":"application/json"}}).then((a=>{e(a)})).catch((e=>{a(e.response)}))})),u=(e,a,t,n)=>new Promise(((u,s)=>{let i={meanings:e,principles:a,openingRemarks:t,title:n};(0,l.A)({method:"post",url:"/api/evaluate/table/update",headers:{"Content-Type":"application/json"},data:JSON.stringify(i)}).then((e=>{u(e)})).catch((e=>{s(e.response)}))}))},8717:function(e,a,t){t.d(a,{A:function(){return p}});t(9138);var l=t(7616),n=t(5929),u=t(3e3),s=t(543),i=t(615);const o={class:"timeline-container"},r={class:"timeline-title"},d={class:"timeline-content"};var c={__name:"TimeLine",setup(e){const a=(0,u.KR)(2),t=(0,u.KR)([{title:"建立评估矩阵关系",description:"07.01-07.05"}]),c=()=>{(0,s.Q)().then((e=>{if(200===e.data.code){t.value=[];for(let l=0;l<=e.data.data.evaluateStep.length-1;l++){const n=e.data.data.evaluateStep[l].startDate.replace(/-/g,"."),u=e.data.data.evaluateStep[l].endDate.replace(/-/g,".");t.value.push({title:e.data.data.evaluateStep[l].description,description:`${n}-${u}`}),1===e.data.data.evaluateStep[l].enable&&(a.value=l)}}else console.log("获取失败！",e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))},v=(0,u.KR)(""),m=()=>{(0,i.r)().then((e=>{200===e.data.code?v.value=e.data.data.title:message.error("获取失败！"+e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))};return(0,l.sV)((()=>{c(),m()})),(e,u)=>{const s=(0,l.g2)("a-popover"),i=(0,l.g2)("a-steps");return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("span",r,(0,n.v_)(v.value)+"-评估流程时间节点",1),(0,l.Lk)("div",d,[(0,l.bF)(i,{current:a.value,"onUpdate:current":u[0]||(u[0]=e=>a.value=e),items:t.value,disabled:!0},{progressDot:(0,l.k6)((({index:e,status:a,prefixCls:t})=>[(0,l.bF)(s,null,{default:(0,l.k6)((()=>[(0,l.Lk)("span",{class:(0,n.C4)(`${t}-icon-dot`)},null,2)])),_:2},1024)])),_:1},8,["current","items"])])])}}},v=t(3578);const m=(0,v.A)(c,[["__scopeId","data-v-566b31ef"]]);var p=m},8098:function(e,a,t){t.r(a),t.d(a,{default:function(){return D}});var l=t(7616),n=t(8717),u=t(3e3),s=t(4490),i=t(6565),o=t(3369),r=t.n(o),d=t(1516),c=t(543);const v={class:"timeset-container"},m={class:"timeset-header"},p={class:"btn-area"},g={key:0,style:{color:"red","margin-bottom":"5px"}},b={class:"timeset-content"},f={class:"timeset-area"},k={class:"save-btn"};var h={__name:"TimeSet",setup(e){const a=(0,u.KR)(!1),t=(0,u.KR)(""),n=()=>{""!==t.value?(a.value=!1,d.Ay.success("名称设置成功，请继续设置时间节点！"),!0===T.value||(T.value=!T.value),h.value="1"):d.Ay.warning("请输入评估周期名称！")},o=(0,u.Kh)({relBuildingTime:[r()("2024-01-01"),r()("2024-01-02")],evaluationTime:[r()("2024-01-05"),r()("2024-01-10")],resCommunicaTime:[r()("2024-02-01"),r()("2024-02-05")],resultReleaseTime:[r()("2024-03-01"),r()("2024-03-05")]}),h=(0,u.KR)("0"),T=(0,u.KR)(!1),y=()=>{a.value=!0},_=()=>{T.value=!T.value,h.value="2"},C=(0,u.KR)(),F=(0,u.KR)(!1),D=()=>{(0,c.Q)().then((e=>{if(200===e.data.code){o.relBuildingTime=[r()(e.data.data.evaluateStep[0].startDate),r()(e.data.data.evaluateStep[0].endDate)],o.evaluationTime=[r()(e.data.data.evaluateStep[1].startDate),r()(e.data.data.evaluateStep[1].endDate)],o.resCommunicaTime=[r()(e.data.data.evaluateStep[2].startDate),r()(e.data.data.evaluateStep[2].endDate)],o.resultReleaseTime=[r()(e.data.data.evaluateStep[3].startDate),r()(e.data.data.evaluateStep[3].endDate)];for(let a=0;a<=e.data.data.evaluateStep.length-1;a++)1===e.data.data.evaluateStep[a].enable&&(C.value=a+1+"","4"===C.value&&(F.value=!0))}else console.log("获取失败！",e.data.msg)})).catch((e=>{console.log("获取失败！",e)}))},S=()=>{const e=(0,u.KR)("");"1"===h.value?e.value="确定要发布新一轮评估吗？":"2"===h.value?e.value="确定要修改评估时间吗？":e.value="undefined";const a=o.relBuildingTime&&o.evaluationTime&&o.resCommunicaTime&&o.resultReleaseTime;a?s.A.confirm({title:e.value,icon:(0,l.bF)(i.A),onOk(){const e=[...o.relBuildingTime.map((e=>e.format("YYYY-MM-DD"))),...o.evaluationTime.map((e=>e.format("YYYY-MM-DD"))),...o.resCommunicaTime.map((e=>e.format("YYYY-MM-DD"))),...o.resultReleaseTime.map((e=>e.format("YYYY-MM-DD")))];"1"===h.value?(0,c.a)(!0,e,t.value).then((e=>{200===e.data.code?(d.Ay.success("发布成功！"),setTimeout((()=>{location.reload()}),500)):(d.Ay.error("发布失败！"+e.data.msg),setTimeout((()=>{location.reload()}),1e3))})).catch((e=>{console.log(e)})):(0,c.a)(!1,e).then((e=>{200===e.data.code?(d.Ay.success("修改成功！"),setTimeout((()=>{location.reload()}),500)):(d.Ay.error("修改失败！"+e.data.msg),setTimeout((()=>{location.reload()}),500))})).catch((e=>{console.log(e)})),T.value=!1},onCancel(){}}):d.Ay.warning("请将所有时间填写完整哦~")};return(0,l.sV)((()=>{D()})),(e,u)=>{const s=(0,l.g2)("a-button"),i=(0,l.g2)("a-input"),r=(0,l.g2)("a-modal"),d=(0,l.g2)("a-range-picker"),c=(0,l.g2)("a-form-item"),h=(0,l.g2)("a-row"),C=(0,l.g2)("a-form");return(0,l.uX)(),(0,l.CE)("div",v,[(0,l.Lk)("div",m,[u[8]||(u[8]=(0,l.Lk)("span",{class:"timeset-title"},"设置评估流程时间节点",-1)),(0,l.Lk)("div",p,[(0,l.bF)(s,{type:"primary",onClick:y,style:{"background-color":"#68BBC4"}},{default:(0,l.k6)((()=>u[6]||(u[6]=[(0,l.eW)("发布新一轮评估时间")]))),_:1}),(0,l.bF)(r,{open:a.value,"onUpdate:open":u[1]||(u[1]=e=>a.value=e),title:"定义新一轮评估名称",okText:"开始设置评估时间",onOk:n},{default:(0,l.k6)((()=>[F.value?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",g,"注意：当前评估还未完成！若仍要发起新一轮评估请继续操作即可~")),(0,l.bF)(i,{value:t.value,"onUpdate:value":u[0]||(u[0]=e=>t.value=e),placeholder:"例如：2023-2024年第一期评估"},null,8,["value"])])),_:1},8,["open"]),(0,l.bF)(s,{type:"primary",onClick:_,ghost:""},{default:(0,l.k6)((()=>u[7]||(u[7]=[(0,l.eW)("修改当前时间节点")]))),_:1})])]),(0,l.Lk)("div",b,[(0,l.Lk)("div",f,[(0,l.bF)(C,null,{default:(0,l.k6)((()=>[(0,l.bF)(h,{gutter:16,style:{"margin-bottom":"20px"}},{default:(0,l.k6)((()=>[(0,l.bF)(c,{label:"建立评估矩阵关系","label-col":{span:8},rules:[{required:!0,message:"请填写！"}],style:{"margin-right":"30px"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:o.relBuildingTime,"onUpdate:value":u[2]||(u[2]=e=>o.relBuildingTime=e),disabled:!T.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1}),(0,l.bF)(c,{label:"上级评估/周边评估","label-col":{span:8},rules:[{required:!0,message:"请填写！"}]},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:o.evaluationTime,"onUpdate:value":u[3]||(u[3]=e=>o.evaluationTime=e),disabled:!T.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1})])),_:1}),(0,l.bF)(h,{gutter:16},{default:(0,l.k6)((()=>[(0,l.bF)(c,{label:"结果沟通",rules:[{required:!0,message:"请填写！"}],style:{"margin-right":"30px"}},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:o.resCommunicaTime,"onUpdate:value":u[4]||(u[4]=e=>o.resCommunicaTime=e),disabled:!T.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1}),(0,l.bF)(c,{label:"结果发布",rules:[{required:!0,message:"请填写！"}]},{default:(0,l.k6)((()=>[(0,l.bF)(d,{value:o.resultReleaseTime,"onUpdate:value":u[5]||(u[5]=e=>o.resultReleaseTime=e),disabled:!T.value,style:{width:"100%"}},null,8,["value","disabled"])])),_:1})])),_:1})])),_:1}),(0,l.Lk)("div",k,[T.value?((0,l.uX)(),(0,l.Wv)(s,{key:0,type:"primary","html-type":"submit",onClick:S},{default:(0,l.k6)((()=>u[9]||(u[9]=[(0,l.eW)("发布 / 修改")]))),_:1})):(0,l.Q3)("",!0)])])])])}}},T=t(3578);const y=(0,T.A)(h,[["__scopeId","data-v-451ae6a8"]]);var _=y,C={__name:"ScoringTimeSet",setup(e){return(e,a)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",null,[(0,l.bF)(n.A)]),(0,l.Lk)("div",null,[(0,l.bF)(_)])],64))}};const F=C;var D=F}}]);
//# sourceMappingURL=98.8ef236e6.js.map