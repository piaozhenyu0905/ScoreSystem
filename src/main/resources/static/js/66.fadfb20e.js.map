{"version":3,"file":"js/66.fadfb20e.js","mappings":"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","sources":["webpack://scoring_system_front/./src/api/todoList.js","webpack://scoring_system_front/./src/api/scoringMatrix.js","webpack://scoring_system_front/./src/page/admin/ScoringMatrix.vue","webpack://scoring_system_front/./src/page/admin/ScoringMatrix.vue?b17b"],"sourcesContent":["import axios from \"axios\";\n\n//获取该时间段内的执行情况数据\nconst getTodoListApi = (pageNum, pageSize) => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/todolist',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        params: {\n            pageNum: pageNum,\n            pageSize: pageSize\n        },\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n//获取人员列表\nconst getUserListApi = () => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/findAll',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        }\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n//提交选择的被评估人\nconst getEvaluatedListApi = (userIds) => new Promise((resolve, reject) =>{\n    let data = {\n        userIds: userIds\n    };\n    axios({\n        method:'post',\n        url:'/api/add/evaluated',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n      data: JSON.stringify(data),\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\nexport{\n    getTodoListApi,\n    getUserListApi,\n    getEvaluatedListApi\n}","import axios from \"axios\";\n\n//获取评分关系矩阵\nconst getScoreMatrixApi = (pageNum, pageSize, name) => new Promise((resolve, reject) =>{\n    let data = {\n        name:name,\n        pageNum: pageNum,\n        pageSize: pageSize\n    };\n    axios({\n        method:'post',\n        url:'/api/find/relationships',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        data: JSON.stringify(data),\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// 添加固定评估人(多选)\nconst getAddEvaluatorApi = (evaluatorIds, userId) => new Promise((resolve, reject) =>{\n    let data = {\n        evaluatorIds: evaluatorIds,  //示例数据:[172, 174, 169]\n        userId: userId\n    }\n    axios({\n        method:'post',\n        url:'/api/add/relationship',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        data: JSON.stringify(data),\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// 删除固定评估人\nconst getDelEvaluatorApi = (evaluatorId, userId) => new Promise((resolve, reject) =>{\n    axios({\n        method:'delete',\n        url:'/api/update/relationship',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        },\n        params: {\n            evaluatorId: evaluatorId,\n            userId: userId\n        },\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\n// 上传矩阵关系文件\nconst getMatrixExcelApi = (file) => new Promise((resolve, reject) => {\n    // 创建 FormData 对象\n    let formData = new FormData();\n    \n    // 将文件添加到 FormData 对象\n    formData.append('file', file);\n\n    // 发起 POST 请求\n    axios({\n        method: 'post',\n        url: '/api/import/relationship',\n        headers: {\n            'Content-Type': 'multipart/form-data',\n        },\n        data: formData,\n    })\n    .then((response) => {\n        // 请求成功的处理\n        resolve(response);\n    })\n    .catch((error) => {\n        // 请求失败的处理\n        reject(error.response);\n    });\n});\n\n// 发布矩阵关系\nconst getPushRelationApi = () => new Promise((resolve, reject) =>{\n    axios({\n        method:'get',\n        url:'/api/relation/step',\n        headers:{\n            \"Content-Type\": \"application/json\",\n        }\n    }).then((response)=>{\n        resolve(response)\n    }).catch((error)=>{\n        reject(error.response)\n    })\n})\n\nexport{\n    getScoreMatrixApi,\n    getAddEvaluatorApi,\n    getDelEvaluatorApi,\n    getMatrixExcelApi,\n    getPushRelationApi\n}","<!-- 管理员/超级管理员--维护评分矩阵 -->\n<script setup>\nimport { reactive, ref, onMounted, onUnmounted } from \"vue\";\nimport { message } from \"ant-design-vue\";\nimport dayjs from \"dayjs\";\nimport {\n  getScoreMatrixApi,\n  getAddEvaluatorApi,\n  getDelEvaluatorApi,\n  getMatrixExcelApi,\n  getPushRelationApi,\n} from \"@/api/scoringMatrix\";\nimport { getUserListApi } from \"@/api/todoList\";\nimport { getStepTimeApi } from \"@/api/scoreTimeSet\";\n\n// 获取当前评估进度\nconst published = ref(false);\nconst currentSession = ref();\n// 获得当前评估进度\nconst getStepTime = () => {\n  getStepTimeApi()\n    .then((res) => {\n      if (res.data.code === 200) {\n        for (let i = 0; i <= res.data.data.evaluateStep.length - 1; i++) {\n          if (res.data.data.evaluateStep[i].enable === 1) {\n            currentSession.value = i + 1 + \"\";\n            if (currentSession.value === \"1\") {\n              published.value = false;\n            } else {\n              published.value = true;\n            }\n          }\n        }\n      } else {\n        message.error(\"获取失败！\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      console.log(\"获取失败！\", err);\n    });\n};\n\n// 搜索框表单数据\nconst serchInfo = reactive({\n  name: null,\n});\n\n// 当前选择的被评估人id\nconst evaluatorId = ref(null);\n// 定义搜索功能提交函数\nconst searchSubmit = () => {\n  pagination.current = 1; // 每次搜索将当前页数变为1\n  // 调用接口进行搜索\n  getScoreMatrix();\n};\n\n// 分页配置\nconst pagination = reactive({\n  // 表格页码相关设置\n  pageSize: 12, //每页最多条目数\n  current: 1, //当前页码\n  showSizeChanger: false,\n  total: 0, //总条目数\n  showTotal: (total, range) => `总共 ${total} 条数据`, // 在这里定义显示总数据量的格式\n});\n\n// 表格的列配置，更新为所需的字段\nconst columns = ref([\n  {\n    title: \"序号\",\n    dataIndex: \"index\",\n    key: \"index\",\n    fixed: \"left\", // 固定在左侧\n    align: \"center\",\n    width: 65,\n  },\n  {\n    title: \"被评估人\",\n    dataIndex: \"name\",\n    key: \"name\",\n    fixed: \"left\", // 固定在左侧\n    align: \"center\",\n    width: 100,\n  },\n  {\n    title: \"主管1\",\n    dataIndex: \"supervisorName1\",\n    key: \"supervisorName1\",\n    align: \"center\",\n    width: 100,\n  },\n  {\n    title: \"主管2\",\n    dataIndex: \"supervisorName2\",\n    key: \"supervisorName2\",\n    align: \"center\",\n    width: 100,\n  },\n  {\n    title: \"主管3\",\n    dataIndex: \"supervisorName3\",\n    key: \"supervisorName3\",\n    align: \"center\",\n    width: 100,\n  },\n  {\n    title: \"主管4\",\n    dataIndex: \"supervisorName4\",\n    key: \"supervisorName4\",\n    align: \"center\",\n    width: 100,\n  },\n  {\n    title: \"固定评估人\",\n    dataIndex: \"relationshipFixed\",\n    key: \"relationshipFixed\",\n    align: \"center\",\n    // width: 80,\n  },\n  {\n    title: \"自主评估人\",\n    dataIndex: \"relationshipSelf\",\n    key: \"relationshipSelf\",\n    align: \"center\",\n    // width: 80,\n  },\n  {\n    title: \"操作\",\n    key: \"action\",\n    fixed: \"right\", // 固定在右侧\n    align: \"center\",\n    width: 160,\n  },\n]);\n\n// 表格数据\nconst tableData = ref([]);\nconst scrollHeight = ref(\"60vh\"); // 定义滚动区域高度\n// 动态更新高度\nconst updateScrollHeight = () => {\n  const screenHeight = window.innerHeight;\n  const containerHeight = screenHeight - 50 - 10; // 假设父容器需要减去固定的偏移量\n  if (screenHeight < 800) {\n    scrollHeight.value = `${containerHeight * 0.62}px`;\n  } else {\n    scrollHeight.value = `${containerHeight * 0.7}px`;\n  }\n};\n// 获取用户表\nconst getScoreMatrix = () => {\n  getScoreMatrixApi(pagination.current, pagination.pageSize, serchInfo.name)\n    .then((res) => {\n      if (res.data.code === 200) {\n        // 设置分页总数\n        pagination.total = res.data.data.total;\n\n        // 清空 data.value，避免多次追加导致重复数据\n        tableData.value = [];\n\n        // 获取数据\n        for (let i = 0; i < res.data.data.data.length; i++) {\n          const Fixed = res.data.data.data[i].relationshipFixedList || [];\n          const Self = res.data.data.data[i].relationshipSelfList || [];\n\n          // 处理固定评估人列表数据\n          const FixedList = Fixed.map((item) => item.name).join(\"、\");\n\n          // 处理自主评估人列表数据\n          const SelfList = Self.map((item) => item.name).join(\"、\");\n\n          tableData.value.push({\n            index:\n              pagination.current * pagination.pageSize -\n              pagination.pageSize +\n              i +\n              1,\n            userId: res.data.data.data[i].userId,\n            name: res.data.data.data[i].name,\n            supervisorName1: res.data.data.data[i].supervisorName1,\n            supervisorName2: res.data.data.data[i].supervisorName2,\n            supervisorName3: res.data.data.data[i].supervisorName3,\n            supervisorName4: res.data.data.data[i].supervisorName4,\n            relationshipFixedList: res.data.data.data[i].relationshipFixedList,\n            relationshipSelfList: res.data.data.data[i].relationshipSelfList,\n            relationshipFixed: FixedList,\n            relationshipSelf: SelfList,\n          });\n        }\n      }\n    })\n    .catch((err) => {\n      message.error(\"请求失败！\", err);\n    });\n};\n\n// 处理翻页\nconst handleTableChange = (e) => {\n  pagination.current = Number(e.current); //更新当前页码\n  pagination.pageSize = e.pageSize; //更新每页显示条目数\n  // sessionStorage.setItem('currentIndex', pagination.current)\n  getScoreMatrix(); // 重新获取列表数据\n};\n\nconst openDetail = ref(false); //查看详情弹窗默认不展示\nconst columnsDetail = ref([\n  {\n    title: \"序号\",\n    dataIndex: \"index\",\n    key: \"index\",\n    width: \"15%\",\n    align: \"center\",\n  },\n  {\n    title: \"用户名\",\n    dataIndex: \"username\",\n    key: \"username\",\n    // width: '15%',\n    align: \"center\",\n  },\n  {\n    title: \"工号\",\n    dataIndex: \"jobuNumber\",\n    key: \"jobuNumber\",\n    // width: '30%',\n    align: \"center\",\n  },\n  {\n    title: \"部门\",\n    dataIndex: \"department\",\n    key: \"department\",\n    // width: '30%',\n    align: \"center\",\n  },\n  {\n    title: \"操作\",\n    key: \"action\",\n    width: \"15%\",\n    align: \"center\",\n  },\n]);\nconst dataDetail = ref([]);\nconst showDetail = (record) => {\n  // 更新当前选择的被评估人id\n  evaluatorId.value = record.userId;\n  // 清空选择列表\n  dataDetail.value = [];\n  for (let i = 0; i < record.relationshipFixedList.length; i++) {\n    dataDetail.value.push({\n      index: i + 1,\n      key: record.relationshipFixedList[i].id,\n      username: record.relationshipFixedList[i].name,\n      jobuNumber: record.relationshipFixedList[i].workNum,\n      department: record.relationshipFixedList[i].department,\n    });\n  }\n  openDetail.value = true;\n};\n// 调用api-删除固定评估人\nconst delOne = (record) => {\n  // 找到与record.key相等的项\n  const index = dataDetail.value.findIndex((item) => item.key === record.key);\n  // 调用api\n  getDelEvaluatorApi(record.key, evaluatorId.value)\n    .then((res) => {\n      if (res.data.code === 200) {\n        message.success(\"删除成功！\");\n        if (index !== -1) {\n          dataDetail.value.splice(index, 1);\n        }\n        getScoreMatrix();\n      } else {\n        message.error(\"删除失败！\"+res.data.msg);\n      }\n    })\n    .catch((err) => {\n      message.error(\"请求失败！\", err);\n    });\n};\nconst openEvaluator = ref(false); //添加评测人弹窗默认不展示\nconst showEvaluator = () => {\n  getUserList();\n  openEvaluator.value = true;\n};\nconst evaluator = ref([]);\nconst options = ref([]);\n// 获取人员列表\nconst getUserList = () => {\n  getUserListApi()\n    .then((res) => {\n      if (res.data.code === 200) {\n        options.value = [\n          {\n            label: \"空值\",\n            value: 0,\n          },\n        ];\n        for (let i = 0; i <= res.data.data.length - 1; i++) {\n          options.value.push({\n            label:\n              res.data.data[i].name + \"(\" + res.data.data[i].department + \")\",\n            value: res.data.data[i].userId,\n            name: res.data.data[i].name,\n          });\n        }\n      } else {\n        message.error(\"获取失败！\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      message.error(\"请求失败！\", err);\n    });\n};\n// 调用api-添加固定评估人\nconst handleEvaluatorOk = () => {\n  // 1、获取评估人key值\n  // 2、调用添加评测人接口\n  const evaluatorIds = Object.values(evaluator.value)\n  // console.log('选择的人',evaluatorIds, '被评估人id', evaluatorId.value)\n\n  if(evaluatorIds.length === 0){\n    message.error('请选择评估人！')\n    return\n  }\n  getAddEvaluatorApi(evaluatorIds, evaluatorId.value)\n    .then((res) => {\n      if (res.data.code === 200) {\n        message.success(\"添加固定评估人成功！^_^\");\n        // 清空选择框\n        evaluator.value = [];\n        // 刷新列表\n        getScoreMatrix();\n        // 3、关闭弹窗\n        openEvaluator.value = false;\n        openDetail.value = false;\n      } else {\n        message.error(res.data.msg);\n      }\n    })\n    .catch((err) => {\n      console.log(\"请求失败！\", err);\n    });\n};\n\n// 引用文件输入框\nconst fileInput = ref(null);\n// 加载状态，控制加载动画\nconst loading = ref(false);\n\n// 触发文件选择框\nconst triggerFileInput = () => {\n  fileInput.value.click();\n};\n\n// 导入矩阵关系\nconst handleFileChange = (event) => {\n  const file = event.target.files[0];\n  if (file) {\n    // 开始上传时显示加载动画\n    loading.value = true;\n\n    // 调用上传接口\n    getMatrixExcelApi(file)\n      .then((res) => {\n        // 请求成功后的操作\n        loading.value = false; // 隐藏加载动画\n        if (res.data.code === 200) {\n          message.success(\"文件上传成功~ =• ֊ •=\");\n          // 刷新页面\n          setTimeout(() => {\n            location.reload();\n          }, 500); // 延迟0.5秒刷新页面\n        } else {\n          message.error(\"文件上传失败，\" + res.data.msg + \"~Z☡zᶻ\");\n        }\n      })\n      .catch((err) => {\n        loading.value = false; // 隐藏加载动画\n        message.error(\"文件上传失败\" + err);\n      });\n  }\n};\n\n// 获取当前时间并格式化\nconst getCurrentDateTime = () => {\n  const now = new Date();\n  const year = now.getFullYear();\n  const month = (now.getMonth() + 1).toString().padStart(2, \"0\"); // 月份是从0开始的\n  const day = now.getDate().toString().padStart(2, \"0\");\n  return `${year}-${month}-${day}`;\n};\n\n// 处理下载 Excel 文件\nconst downloadExcel = () => {\n  // 获取当前时间（年月日时分）\n  const currentDateTime = getCurrentDateTime();\n\n  // 获取 Excel 文件的 URL（通过静态资源引用）\n  const fileUrl = new URL(\"@/assets/矩阵关系模板.xlsx\", import.meta.url).href;\n\n  // 创建一个临时的 <a> 元素来触发下载\n  const a = document.createElement(\"a\");\n  a.href = fileUrl; // 设置下载文件的 URL\n  a.download = `用户信息模板${currentDateTime}.xlsx`; // 设置下载时的文件名\n  a.click(); // 模拟点击，触发下载\n};\n\n// 发布矩阵关系\nconst getPushRelation = () => {\n  getPushRelationApi()\n    .then((res) => {\n      if (res.data.code === 200) {\n        message.success(\"您已发布本轮评估矩阵关系!\");\n        published.value = true;\n      } else {\n        message.error(\"发布失败！\" + res.data.msg);\n      }\n    })\n    .catch((err) => {\n      message.error(\"请求失败！\" + err);\n    });\n};\n\n// 初始加载数据\nonMounted(() => {\n  getScoreMatrix();\n  getStepTime();\n  updateScrollHeight();\n  window.addEventListener(\"resize\", updateScrollHeight);\n});\n\n// 在组件卸载时移除事件监听\nonUnmounted(() => {\n  window.removeEventListener(\"resize\", updateScrollHeight);\n});\n</script>\n\n<template>\n  <div class=\"score-matrix\">\n    <!-- 表格顶部区域 -->\n    <div class=\"content-header\">\n      <!-- 搜索表单 -->\n      <div class=\"search-form\">\n        <a-form style=\"display: flex; align-items: center\">\n          <a-form-item style=\"margin-right: 10px; width: 300px\">\n            <a-input\n              placeholder=\"请输入被评估人姓名\"\n              v-model:value=\"serchInfo.name\"\n              :allowClear=\"true\"\n            />\n          </a-form-item>\n          <a-form-item>\n            <a-button\n              type=\"primary\"\n              @click.prevent=\"searchSubmit\"\n              class=\"seachBtn\"\n              >搜索</a-button\n            >\n          </a-form-item>\n        </a-form>\n      </div>\n      <!-- 右侧按钮 -->\n      <div class=\"submit-Btn\">\n        <a-button\n          type=\"primary\"\n          style=\"margin-right: 10px\"\n          @click=\"triggerFileInput\"\n          >导入数据</a-button\n        >\n        <a-button\n          type=\"primary\"\n          style=\"margin-right: 10px\"\n          @click=\"downloadExcel\"\n          >导出模板</a-button\n        >\n        <a-popconfirm\n          placement=\"bottom\"\n          title=\"确定要发布本轮矩阵关系吗？\"\n          ok-text=\"确定\"\n          cancel-text=\"取消\"\n          @confirm=\"getPushRelation()\"\n        >\n          <a-button\n            v-if=\"!published\"\n            type=\"primary\"\n            style=\"background-color: #39ba06\"\n          >\n            发布\n          </a-button>\n        </a-popconfirm>\n        <a-button v-if=\"published\" type=\"primary\" disabled> 已发布 </a-button>\n        <!-- 隐藏的文件上传输入框 -->\n        <input\n          ref=\"fileInput\"\n          type=\"file\"\n          accept=\".xls,.xlsx\"\n          style=\"display: none\"\n          @change=\"handleFileChange\"\n        />\n\n        <!-- 显示加载动画 -->\n        <a-spin :spinning=\"loading\" class=\"loading-spin\" size=\"large\" />\n      </div>\n    </div>\n    <!-- 表格内容区域 -->\n    <div class=\"content-table\">\n      <!-- 表格 -->\n      <a-table\n        :columns=\"columns\"\n        :data-source=\"tableData\"\n        :rowKey=\"(record) => record.key\"\n        :scroll=\"{ y: scrollHeight }\"\n        :pagination=\"pagination\"\n        :bordered=\"true\"\n        @change=\"handleTableChange\"\n      >\n        <!-- 自定义渲染操作列 -->\n        <template v-slot:bodyCell=\"{ text, record, column }\">\n          <!-- 检查当前列是否为操作列 -->\n          <template v-if=\"column.key === 'action'\">\n            <a-button\n              type=\"text\"\n              @click=\"showDetail(record)\"\n              style=\"color: #0014b7\"\n              >修改固定评估人</a-button\n            >\n          </template>\n          <!-- 对其他列使用默认渲染 -->\n          <template v-else>\n            {{ text }}\n          </template>\n        </template>\n      </a-table>\n      <!-- 查看详情弹窗 -->\n      <a-modal v-model:open=\"openDetail\" title=\"修改固定评估人\" :footer=\"null\">\n        <a-table\n          :columns=\"columnsDetail\"\n          :data-source=\"dataDetail\"\n          :bordered=\"true\"\n          :pagination=\"false\"\n          :scroll=\"{ y: '60vh' }\"\n        >\n          <template #bodyCell=\"{ column, record }\">\n            <!-- 设置操作栏 -->\n            <template v-if=\"column.key === 'action'\">\n              <a-popconfirm\n                title=\"确定要移除吗？\"\n                ok-text=\"确定\"\n                cancel-text=\"取消\"\n                @confirm=\"delOne(record)\"\n              >\n                <a style=\"color: #bd3124; font-weight: bold\"> 移除 </a>\n              </a-popconfirm>\n            </template>\n          </template>\n        </a-table>\n        <div class=\"actionBtn\">\n          <a-button type=\"primary\" @click=\"showEvaluator\">添加评估人</a-button>\n        </div>\n      </a-modal>\n      <!-- 添加评估人弹窗 -->\n      <a-modal\n        v-model:open=\"openEvaluator\"\n        title=\"添加评估人\"\n        @ok=\"handleEvaluatorOk\"\n      >\n        <a-select \n            v-model:value=\"evaluator\" \n            :options=\"options\" \n            mode=\"multiple\" \n            placeholder=\"请选择\" \n            style=\"width: 100%\">\n        </a-select>\n        <!-- <a-select\n          v-model:value=\"evaluator\"\n          placeholder=\"请选择\"\n          style=\"width: 100%\"\n        >\n          <a-select-option\n            v-for=\"item in options\"\n            :key=\"item.key\"\n            :value=\"item.key\"\n            >{{ item.value }}</a-select-option\n          >\n        </a-select> -->\n      </a-modal>\n    </div>\n  </div>\n</template>\n\n<style lang=\"less\" scoped>\n.score-matrix {\n  // border: 1px solid red;\n  width: 100%;\n  height: 100%;\n}\n\n.content-header {\n  // border: 1px solid red;\n  display: flex;\n  align-items: center;\n  margin: 0px 10px 0px 10px;\n  height: 50px;\n\n  .submit-Btn {\n    margin-left: auto;\n    margin-bottom: 10px;\n  }\n}\n\n.content-table {\n  // border: 1px solid red;\n  height: calc(100% - 50px - 10px);\n  margin: 0 10px;\n}\n\n.actionBtn {\n  text-align: center;\n  /* 使按钮水平居中 */\n  margin-top: 10px;\n  /* 添加一些间距，让布局更美观 */\n}\n\n.loading-spin {\n  position: fixed;\n  /* 使得a-spin脱离正常文档流 */\n  top: 6%;\n  /* 距离顶部6% */\n  left: 50%;\n  /* 距离左边50% */\n  transform: translate(-50%, -50%);\n  /* 使用transform将a-spin精确居中 */\n  z-index: 9999;\n  /* 确保a-spin在最前面 */\n}\n\n.ant-form-item {\n  margin-bottom: 10px !important;\n}\n\n::v-deep .ant-table-tbody > tr > td {\n  padding: 8px;\n  /* 根据需要调整 */\n}\n</style>","import script from \"./ScoringMatrix.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ScoringMatrix.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ScoringMatrix.vue?vue&type=style&index=0&id=4551262c&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_vue@3.5.10_webpack@5.95.0/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4551262c\"]])\n\nexport default __exports__"],"names":["getTodoListApi","pageNum","pageSize","Promise","resolve","reject","axios","method","url","headers","params","then","response","catch","error","getUserListApi","getEvaluatedListApi","userIds","data","JSON","stringify","getScoreMatrixApi","name","getAddEvaluatorApi","evaluatorIds","userId","getDelEvaluatorApi","evaluatorId","getMatrixExcelApi","file","formData","FormData","append","getPushRelationApi","published","ref","currentSession","getStepTime","getStepTimeApi","res","code","i","evaluateStep","length","enable","value","message","msg","err","console","log","serchInfo","reactive","searchSubmit","pagination","current","getScoreMatrix","showSizeChanger","total","showTotal","range","columns","title","dataIndex","key","fixed","align","width","tableData","scrollHeight","updateScrollHeight","screenHeight","window","innerHeight","containerHeight","Fixed","relationshipFixedList","Self","relationshipSelfList","FixedList","map","item","join","SelfList","push","index","supervisorName1","supervisorName2","supervisorName3","supervisorName4","relationshipFixed","relationshipSelf","handleTableChange","e","Number","openDetail","columnsDetail","dataDetail","showDetail","record","id","username","jobuNumber","workNum","department","delOne","findIndex","success","splice","openEvaluator","showEvaluator","getUserList","evaluator","options","label","handleEvaluatorOk","Object","values","fileInput","loading","triggerFileInput","click","handleFileChange","event","target","files","setTimeout","location","reload","getCurrentDateTime","now","Date","year","getFullYear","month","getMonth","toString","padStart","day","getDate","downloadExcel","currentDateTime","fileUrl","URL","href","a","document","createElement","download","getPushRelation","onMounted","addEventListener","onUnmounted","removeEventListener","__exports__"],"sourceRoot":""}